(self.legacyJsonp=self.legacyJsonp||[]).push([[81337],{204813:function(e,t,r){"use strict";r.d(t,{Z:function(){return X}});var s=r(284987),o=r(132227),n=r(857147),a=r(538645),i=r(127433),l=r(258712),c=r(19963),d=r(182997),u=r(846382),_=r(231333),p=r(233846),w=r(51340),h=r(160764),f=r(170453),g=r(693806),m=r(732070),P=r(986499),v=r(262368),x=r(967312),y=r(289257),b=r(174646),C=r(142212),j=r(112800),k=r(339908),A=r(269136),S=r(882368),z=r(717616),O=r(331935),E=r(852015),R=r(19035),T=function(e){var t=e.onDismiss,r=e.googleConnect,s=(0,p.ZP)();return(0,R.jsx)(E.ZP,{accessibilityModalLabel:r?s._('Successfully connect to Google', 'Accessible_label.user_connect_google_success', 'Accessible label for success message after google login'):s._('Successfully changed password', 'Accessible label for success message after password reset', 'Accessible label for success message after password reset'),footer:(0,R.jsx)(o.xu,{children:(0,R.jsx)(o.rU,{href:C.ZEf,onClick:function(e){return(0,e.dangerouslyDisableOnNavigation)()},children:(0,R.jsx)(o.zx,{color:"red",fullWidth:!0,onClick:t,text:r?s._('Log in now', 'Acknowledgement.successful_google_connect', 'Acknowledgement of successful google connect'):s._('Okay', 'Acknowledgement of successful password change', 'Acknowledgement of successful password change')})})}),heading:r?s._('Google login saved!', 'Notice.user_connect_google_success', 'Notice that a user successfully setup Google login'):s._('Password changed!', 'Notice that a user successfully changed their password', 'Notice that a user successfully changed their password'),onDismiss:t,size:"md",children:(0,R.jsx)(o.xu,{padding:4,children:!r&&(0,R.jsx)(o.xv,{children:s._('Your password has been changed successfully', 'Notice that a user successfully changed their password', 'Notice that a user successfully changed their password')})})})},D=r(992114),M=r(757653);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach(function(t){U(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function L(e,t,r,s,o,n,a){try{var i=e[n](a),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(s,o)}function V(e){return function(){var t=this,r=arguments;return new Promise(function(s,o){var n=e.apply(t,r);function a(e){L(n,s,o,a,i,"next",e)}function i(e){L(n,s,o,a,i,"throw",e)}a(void 0)})}}function G(e,t){return(G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function N(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(W=function(){return!!e})()}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t,r){return(t=H(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H(e){var t=function(e,t){if("object"!=Z(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=Z(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Z(t)?t:t+""}var I=(0,M.Z)(function(){return Promise.resolve().then(r.bind(r,983311))},void 0,function(e){return 983311},"app-packages-PasswordStrengthWrapper"),Y=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&G(i,e);var t,r,s,n,a=(t=W(),function(){var e,r=B(i);return e=t?Reflect.construct(r,arguments,B(this).constructor):r.apply(this,arguments),function(e,t){if(t&&("object"==Z(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return N(e)}(this,e)});function i(){var e,t,r,s,o;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var n=arguments.length,l=Array(n),c=0;c<n;c++)l[c]=arguments[c];return U(N(e=a.call.apply(a,[this].concat(l))),"state",{errors:{newPassword:[],newPasswordConfirm:[]},newPassword:"",newPasswordConfirm:"",showConfirmation:!1,showGoogleButton:!1,googleConnected:!1,data:null,recaptchaV3Token:void 0}),U(N(e),"requiredValidator",(0,O.aH)({message:e.props.i18n._('Required', 'Validation error when a required field is missing', 'Validation error when a required field is missing')})),U(N(e),"validators",{newPassword:e.props.getPasswordValidationRules({username:e.props.options.username}),newPasswordConfirm:{required:e.requiredValidator,equalTo:function(t){return(0,O.sG)({targetValue:t,message:e.props.i18n._('Passwords don\u2018t match', ' - ', ' -- ')})}}}),U(N(e),"handlePasswordFieldChange",(t=V(regeneratorRuntime.mark(function t(r,s){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState(U({},r,s)),t.next=3,e.validateFields(r,s);case 3:case"end":return t.stop()}},t)})),function(e,r){return t.apply(this,arguments)})),U(N(e),"handleSubmitSuccess",function(t,r){t.resource_response.data.password_changed&&(e.props.logContextEvent({event_type:52,view_type:7,view_parameter:53,component:141,aux_data:{reset_password_page_version:"react",passcode_updated:!!r}}),e.setState({showConfirmation:!0}),(0,j.My)("unauth.dweb.password_reset_from_email.success"))}),U(N(e),"handleSubmitFailure",function(t){var r;t.api_error_code===g.Zn?(r={showConfirmation:!0},e.props.logContextEvent({event_type:52,view_type:7,view_parameter:53,component:141,aux_data:{reset_password_page_version:"react"}})):t.api_error_code===g.QY?r={newPassword:"",newPasswordConfirm:"",errors:{newPassword:[],newPasswordConfirm:[]},data:{is_link_valid:!1}}:t.api_error_code?r={newPassword:"",newPasswordConfirm:"",errors:{newPassword:[t.message_detail||t.message],newPasswordConfirm:[]}}:((0,D.nP)("www.dWeb.passwordChange.failed",{sampleRate:1,tags:{error_message_detail:t.message_detail,error_message:t.message,api_error_code:t.api_error_code,httpStatus:t.httpStatus}}),r={newPassword:"",newPasswordConfirm:"",errors:{newPassword:[e.props.i18n._('Something went wrong. Please try again later.', 'unauth.dWeb.passwordReset.somethingWentWrong', 'Generic error message')],newPasswordConfirm:[]}}),e.setState(F({},r))}),U(N(e),"handleResetPassword",(r=V(regeneratorRuntime.mark(function t(r,s){var o,n,a,i,l,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=(o=e.props.parentalPassCodeContext||{}).closeModal,a=o.setErrorMessage,i=o.setModalPropsAndOpen,t.prev=1,t.next=4,(0,P.Z)(F(F({},r),{},{passcode:s}));case 4:l=t.sent,null==n||n(),e.handleSubmitSuccess(l,s),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(1),c=t.t0,(0,h.x)({apiErrorCode:null==c?void 0:c.api_error_code,onShowMessage:function(){null==a||a(c.message)},onPassCodeRequired:function(){null==i||i({handlePasscodeSent:function(){var t=V(regeneratorRuntime.mark(function t(s){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.handleResetPassword(r,s);case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()})},onPassCodeSkipConfirmation:function(){}}),e.handleSubmitFailure(c);case 14:case"end":return t.stop()}},t,null,[[1,9]])})),function(e,t){return r.apply(this,arguments)})),U(N(e),"handleSubmit",(s=V(regeneratorRuntime.mark(function t(r){var s,o,n,a,i,l,c,d,u;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r.event.preventDefault(),o=(s=e.state).newPassword,n=s.newPasswordConfirm,a=s.recaptchaV3Token,l=(i=e.props).isOnPasswordStrengthExperiment,d=(c=i.options).expiration,u={expiration:d,new_password:o,new_password_confirm:l?o:n,token:c.token,username:c.username,recaptcha_v3_token:a},l&&(0,e.props.logContextEvent)({event_type:16896,component:141,element:128,aux_data:{score_source:"zxcvbn",score:(0,z.tc)(o),surface:"RESET_PASSWORD"}}),e.handleResetPassword(u);case 8:case"end":return t.stop()}},t)})),function(e){return s.apply(this,arguments)})),U(N(e),"handleGoogleConnect",function(t){var r=e.props,s=r.showToastAndClose,o=r.i18n,n=r.logContextEvent,a=r.requestContext;(0,P.J)({i18n:o,requestContext:a},t,{success:function(){s({state:"success",message:o._('You\'re logged in with Google!', 'unauthGoogleconnect.success.toast', 'toast for unauth google connect success')}),n({event_type:15395,component:141,element:208}),(0,j.My)("unauth.dweb.password_reset.google_connect_success"),e.setState({showConfirmation:!0,googleConnected:!0})},error:function(t){t&&t.api_error_code===g.Zn?(e.setState({showConfirmation:!0,googleConnected:!0}),e.props.logContextEvent({event_type:15395,element:208,component:141})):t&&t.api_error_code===g.pH?(s({state:"error",message:o._('This account is already linked to another Pinterest user', 'unauth_google_link.already_in_use.error_toast', 'Error text on google account already in use unauth')}),n({event_type:15397,component:141,element:208,aux_data:{fail_reason:"google_dup"}}),(0,j.My)("unauth.dweb.password_reset.google_connect_duplicate")):t&&(s({state:"error",message:o._('Unable to connect to Google. Please try again', 'unauth_google_link.connection_fail.error_toast', 'Error text on google account connection failure unauth')}),n({event_type:15397,component:141,element:208,aux_data:{fail_reason:t.api_error_code}}),(0,j.My)("unauth.dweb.password_reset.google_connect_error.".concat(t.api_error_code)))},complete:function(){}})}),U(N(e),"validateFields",(0,d.Z)((o=V(regeneratorRuntime.mark(function t(r,s){var o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o={},"newPassword"!==r){t.next=9;break}return t.next=4,e.runAsyncValidators(r,s);case 4:o={newPassword:t.sent,newPasswordConfirm:e.state.newPasswordConfirm?e.runValidators("newPasswordConfirm",e.state.newPasswordConfirm,s):[]},t.next=11;break;case 9:o={newPasswordConfirm:e.runValidators("newPasswordConfirm",s,e.state.newPassword)};case 11:e.setState(function(e){return{errors:F(F({},e.errors),o)}});case 12:case"end":return t.stop()}},t)})),function(e,t){return o.apply(this,arguments)}),300)),U(N(e),"dismissConfirmationModal",function(){return e.setState({showConfirmation:!1})}),e}return n=[{key:"componentDidMount",value:(r=V(regeneratorRuntime.mark(function e(){var t,r,s,o,n,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.isUnauth){e.next=3;break}return this.setState({data:this.props.data}),e.abrupt("return");case 3:if(r=(t=this.props.options).username,s=t.token,o=t.expiration,!(this.props.currentUsername===r&&this.props.isLimitedLogin&&this.props.logout)){e.next=7;break}return e.next=7,this.props.logout({source:"password-reset"});case 7:(0,v.Z)({expiration:o,token:s,username:r}).then(function(e){var t=e.resource_response.data,r=t.is_link_valid,s=t.is_google_eligible;a.setState({data:e.resource_response.data}),(0,j.My)("unauth.dweb.password_reset.verify_link_from_email"),r&&s&&a.props.checkExperiment("unauth_google_connect_on_reset_password_page").anyEnabled?(a.props.logContextEvent({event_type:15393,component:141,aux_data:{reset_password_page_version:"google"}}),(0,j.My)("unauth.dweb.password_reset.google_password_version_view"),a.setState({showGoogleButton:!0})):(a.props.logContextEvent({event_type:15393,component:141,aux_data:{reset_password_page_version:r?"pwd":"invalid"}}),(0,j.My)("unauth.dweb.password_reset.is_link_valid.".concat(r)))}).catch(function(){a.props.logContextEvent({event_type:15393,component:141,aux_data:{reset_password_page_version:"error"}}),a.setState({data:{is_link_valid:!1,is_google_eligible:!1}})}),(n=function(){(0,y.rY)(function(e){return a.setState({recaptchaV3Token:e})},function(){},y.Ec)})(),setInterval(n,y.yc);case 11:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"runValidators",value:function(e,t,r){var s=this.validators[e];"newPasswordConfirm"===e&&(s=F(F({},s),{equalTo:s.equalTo(r)}));var o=Object.values(s);return(0,O.FU)(o,t)}},{key:"runAsyncValidators",value:(s=V(regeneratorRuntime.mark(function e(t,r,s){var o,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.validators[t],"newPasswordConfirm"!==t){e.next=5;break}return n=Object.values(o=F(F({},o),{equalTo:o.equalTo(s)})),e.abrupt("return",(0,O.FU)(n,r));case 5:return a=Object.values(o),e.abrupt("return",(0,O.Ks)(a,r));case 7:case"end":return e.stop()}},e,this)})),function(e,t,r){return s.apply(this,arguments)})},{key:"render",value:function(){var e,t=this,r=this.state,s=r.newPassword,n=r.newPasswordConfirm,a=r.errors,i=r.showGoogleButton,c=this.state.data,d=this.props,_=d.i18n,p=d.isOnPasswordStrengthExperiment,h=d.logContextEvent,f=this.props.options,g=f.expiration,m=f.token,P=f.username;if(p)e=s&&!a.newPassword.length;else{var v=a.newPassword.length+a.newPasswordConfirm.length;e=!!(s&&n)&&s===n&&!v}if(!c)return null;var x=c.is_link_valid;return(0,R.jsxs)(o.kC,{alignItems:"center",direction:"column",justifyContent:"center",children:[!x&&(0,R.jsxs)(o.xu,{"data-test-id":"web-reset-pass-header",display:"block",maxWidth:450,width:"58.33333%",children:[(0,R.jsx)(o.X6,{align:"center",children:_._('Sorry', 'unauth.dweb.passwordReset.sorryHeading', 'Heading when a reset password link is invalid')}),(0,R.jsx)(o.xu,{marginTop:6,children:(0,R.jsx)(o.xv,{align:"center",children:_._('The password reset link was invalid / expired (valid for 24 hrs), possibly because it has already been used.', 'unauth.dweb.passwordReset.linkInvalidtext', 'Explanation of why a user is unable to reset their password from the current link')})}),(0,R.jsx)(o.xu,{marginTop:6,children:(0,R.jsx)(o.xv,{align:"center",children:(0,w.nk)(_._('Please request a {{anchorTag}}', 'unauth.dweb.passwordReset.newResetLinkText', 'Prompt to click for new password reset email'),{anchorTag:(0,R.jsx)(o.xv,{color:"default",inline:!0,weight:"bold",children:(0,R.jsx)(o.rU,{display:"inlineBlock",href:C.lfe,underline:"hover",children:_._('new password reset', 'unauth.dweb.passwordReset.newResetLinkText.link', 'Fragment of invalid password reset link message.Prompt to request a new reset password link')},"invalidLink")})})})})]}),x&&i&&(0,R.jsx)(o.xu,{alignItems:"center",display:"flex",height:64,justifyContent:"center",marginBottom:4,width:1005,children:(0,R.jsx)(o.he,{iconAccessibilityLabel:"Info",message:_._('Choose how to get back into your account: Set up Google login, or set a password', 'resetPasswordPage.banner.text', 'text for reset password page banner'),onDismiss:function(){h({event_type:15394,component:141})},type:"info"})}),x&&(0,R.jsx)("form",{method:"POST",onSubmit:this.handleSubmit,style:{width:"100%",justifyContent:"space-around",display:"flex"},children:(0,R.jsxs)(o.xu,{"data-test-id":"web-reset-pass-header",display:"block",maxWidth:i?360:450,width:"58.33333%",children:[i?(0,R.jsxs)(o.xu,{children:[(0,R.jsx)(u.Z,{onClick:function(){return function(){(0,j.My)("unauth.dweb.password_reset.google_connect_click"),h({event_type:15392,component:141,element:208}),t.handleGoogleConnect({username:P,token:m,expiration:g})}},textOption:"accountRecovery"}),(0,R.jsx)(o.xu,{marginTop:2,paddingY:4,children:(0,R.jsxs)(o.xv,{align:"center",weight:"bold",children:[" ",_._('OR', 'divider.password_reset_page.text', 'divider text on password reset page')," "]})})]}):(0,R.jsx)(o.X6,{align:"center",children:_._('Pick a new password', 'Prompt to pick a new password', 'Prompt to pick a new password')}),(0,R.jsxs)(o.xu,{children:[(0,R.jsx)(o.xu,{marginBottom:2,marginTop:4,children:(0,R.jsx)(o.__,{htmlFor:"newPassword",children:(0,R.jsx)(o.xv,{weight:i?"normal":"bold",children:_._('New password', 'Field label for entering a new password', 'Field label for entering a new password')})})}),(0,R.jsx)(o.nv,{dataTestId:"new-password",errorMessage:Array.isArray(a.newPassword[0])?a.newPassword[0].join(""):a.newPassword[0],id:"newPassword",onChange:function(e){var r=e.value;t.handlePasswordFieldChange("newPassword",r)},size:"lg",type:"password",value:this.state.newPassword}),(0,R.jsx)(I,{password:this.state.newPassword}),!p&&(0,R.jsxs)(l.Fragment,{children:[(0,R.jsx)(o.xu,{marginBottom:2,marginTop:4,children:(0,R.jsx)(o.__,{htmlFor:"confirmNewPassword",children:(0,R.jsx)(o.xv,{weight:i?"normal":"bold",children:_._('Type it again', 'Prompt to repeat the desired password', 'Prompt to repeat the desired password')})})}),(0,R.jsx)(o.nv,{dataTestId:"confirm-new-password",errorMessage:Array.isArray(a.newPasswordConfirm[0])?a.newPasswordConfirm[0].join(""):a.newPasswordConfirm[0],id:"confirmNewPassword",onChange:function(e){var r=e.value;t.handlePasswordFieldChange("newPasswordConfirm",r)},size:"lg",type:"password",value:this.state.newPasswordConfirm})]})]}),(0,R.jsx)(o.xu,{display:"flex",justifyContent:i?"center":"end",marginTop:i?6:4,children:(0,R.jsx)(o.zx,{color:"red",disabled:!e,fullWidth:!!i,onClick:this.handleSubmit,size:i?"lg":"md",text:_._('Change Password', ' - ', ' -- '),type:"submit"})})]})}),this.state.showConfirmation&&(0,R.jsx)(T,{googleConnect:this.state.googleConnected,onDismiss:this.dismissConfirmationModal})]})}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,H(s.key),s)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(l.Component);function J(e){var t=(0,c.v)().logContextEvent,r=(0,p.ZP)(),s=(0,A.Z)(),o=(0,m.aU)(),n=(0,S.Z)(),a=(0,b.B)(),i=(0,x.F)().checkExperiment,l=(0,k.F9)().showToast,d=(0,f.J)();return(0,R.jsx)(Y,F(F({},e),{},{checkExperiment:i,currentUsername:n.isAuth?n.username:void 0,getPasswordValidationRules:s,i18n:r,isLimitedLogin:n.isLimitedLogin,isOnPasswordStrengthExperiment:i("web_strong_password").anyEnabled,logContextEvent:t,logout:o,parentalPassCodeContext:d,requestContext:a,showToastAndClose:function(e){var t=e.state,r=e.message;l(function(e){var s=e.hideToast;return(0,R.jsx)(_.Z,{onHide:s,text:r,type:t})})}}))}var X=function(){var e=(0,s.TH)(),t=(0,s.UO)().username,r=(0,n.mB)(e.search);return"desktop"===(0,a.ZP)()?(0,R.jsx)(o.xu,{marginTop:8,children:(0,R.jsx)(J,{options:{username:t||"",expiration:r.e,token:r.t}})}):(0,R.jsx)(i.Z,{})}},621913:function(e,t,r){(window.__PWS_LOADED_HANDLERS__=window.__PWS_LOADED_HANDLERS__||[]).push(["www/pw/[username]",function(){return r(204813).Z}])}},function(e){e.O(0,[97270,32227,6194,76175,8789,46611,55965,5966,70453,17616,79217],function(){return e(e.s=621913)}),e.O()}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/www/pw/[username]-53b97fd5698cc722.js.map