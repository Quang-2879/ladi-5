"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([[1450],{302926:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"ActivityAvatar_user",selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null}],type:"User",abstractKey:null};r.hash="abf151ba4d389a02e4541aa5f969d468",t.default=r},637129:function(e,t,n){n.r(t);var r,o,i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"AggregatedCommentListUnified_pin",selections:[{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:o=[r={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"highlightedAggregatedComments",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null}],type:"Pin",abstractKey:null};i.hash="ba6cb3d83648d5a9f07e044db4a9cf58",t.default=i},254377:function(e,t,n){var r;void 0===r&&(r=n.g),t.Z={setTimeout:function(e,t){return r.setTimeout(e,t)},clearTimeout:function(e){return r.clearTimeout(e)},setInterval:function(e,t){return r.setInterval(e,t)},clearInterval:function(e){return r.clearInterval(e)}}},909598:function(e,t,n){n.d(t,{Z:function(){return u}}),n(53583);var r,o=n(132227),i=n(971518),a=n(962119),l=n(882368),s=n(19035),c=void 0!==r?r:r=n(302926);function u(e){var t,n=e.userKey,r=e.size,u=e.hasOutline,d=(0,a.Z)(c,n),p=(0,l.Z)(),f=p.isAuth?null==p?void 0:p.avatar_color_index:void 0;if(!d)return null;var h=d.firstName,m=d.imageMediumUrl,g=null!=(t=d.username)?t:"";return(0,s.jsx)(o.Tg,{href:"/".concat(g,"/"),rounding:"circle",children:(0,s.jsx)(i.qE,{color:f,name:h||g||"",outline:u,size:void 0===r?"md":r,src:null!=m?m:""})})}},450745:function(e,t,n){n.d(t,{K:function(){return a},Q:function(){return i}});var r=n(258712),o=(0,r.createContext)(null),i=o;function a(){var e=(0,r.useContext)(o);return null==e?void 0:e.featuredCommentId}},71408:function(e,t,n){n.d(t,{Z:function(){return eQ}});var r=n(258712),o=n(132227),i=n(115157),a=n(545007),l=n(766178),s=n(87134),c=n(19963),u=n(216029),d=n(578373),p=n(267708),f=n(346611),h=n(233846),m=n(970601),g=n(143759),y=n(19035);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){w(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(P=function(){return!!e})()}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t,n){return(t=C(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}var S="\n.uploadProgressBar {\n  background-color: ".concat(f.x_d,";\n  border-radius: 8px;\n  height: 16px;\n  opacity: 1;\n  position: absolute;\n  transition: opacity 85ms ease-in, width 85ms ease-in;\n  z-index: 10;\n\n  &.transition {\n    opacity: 0;\n    transition: opacity 85ms ease-in, width 85ms ease-in;\n  }\n}\n"),A=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&x(a,e);var t,n,i=(t=P(),function(){var e,n=O(a);return e=t?Reflect.construct(n,arguments,O(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==_(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return j(e)}(this,e)});function a(){var e;if(!(this instanceof a))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return w(j(e=i.call.apply(i,[this].concat(n))),"_videoContainerRef",null),w(j(e),"removeVideoTag",function(){e._videoContainerRef&&e._videoContainerRef.childNodes[0]&&e._videoContainerRef.removeChild(e._videoContainerRef.childNodes[0])}),w(j(e),"clear",function(t){t.event.stopPropagation(),e.removeVideoTag(),e.props.handleRemoveClick()}),e}return n=[{key:"isPin",get:function(){var e=this.props,t=e.display,n=e.imagePreviewSrc,r=e.videoUrls;return"pin"===t&&(!!n||!!r)}},{key:"renderProgressBar",value:function(){var e=this.props.progress;return(0,y.jsx)("div",{className:100===e||0===e?"uploadProgressBar transition":"uploadProgressBar",style:{width:"".concat(e,"%")}})}},{key:"renderDropZone",value:function(){return(0,y.jsxs)(o.xu,{children:[(0,y.jsx)(o.kC,{alignItems:"center",justifyContent:"center",children:(0,y.jsx)(o.kC,{alignItems:"center",justifyContent:"center",children:(0,y.jsx)(o.JO,{accessibilityLabel:this.props.i18n._('Add a Photo', 'Add a photo as part of a form', 'Add a photo as part of a form'),color:"default",icon:"camera",size:32})})}),(0,y.jsx)(o.xu,{marginTop:2,paddingX:12,children:(0,y.jsx)(o.xv,{align:"center",color:"default",weight:"bold",children:this.props.i18n._('Drag and drop or click to upload', 'Label on drag/drop area for uploading a pin', 'Label on drag/drop area for uploading a pin')})})]})}},{key:"renderImage",value:function(){var e=this.props,t=e.height,n=e.imagePreviewSrc,r=e.width,i=this.props.i18n._('Your Upload', 'Image a pinner just uploaded to a form', 'Image a pinner just uploaded to a form');return this.isPin?(0,y.jsx)(o.Ee,{alt:i,src:n}):(0,y.jsx)(o.xu,{height:t,width:r,children:(0,y.jsx)(o.Ee,{alt:i,color:"white",naturalHeight:t,naturalWidth:r,src:n})})}},{key:"renderResetButton",value:function(){return(0,y.jsx)(o.xu,{left:!0,margin:2,position:"absolute",top:!0,children:(0,y.jsx)(o.hU,{accessibilityLabel:this.props.i18n._('Remove Photo', 'Remove photo from a form', 'Remove photo from a form'),bgColor:"lightGray",icon:"clear",iconColor:"darkGray",onClick:this.clear,size:"sm"})})}},{key:"renderContent",value:function(){var e=this.props,t=e.height,n=e.imagePreviewSrc,i=e.isHovering,a=e.isVideo,l=e.isVideoComplete,s=e.isOver,c=e.thumbnail,u=e.videoUrls,d=e.allowReset,p=e.width,f=u?(0,y.jsx)("video",{autoPlay:!0,controls:!0,height:this.isPin?"auto":t,loop:!0,poster:c||"",width:p,children:Object.keys(u).map(function(e){return(0,y.jsx)("source",{src:u[e],type:"hls"===e?"m3u8":"video/mp4"},e)})}):null;return(0,y.jsxs)(r.Fragment,{children:[(0,y.jsx)(o.zd,{height:"100%",rounding:2,children:(0,y.jsxs)(o.xu,{alignItems:"center",color:s?"secondary":"default",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[!n&&!a&&this.renderDropZone(),a&&!u&&(0,y.jsxs)(o.xu,{children:[l&&(0,y.jsx)(o.xv,{align:"center",weight:"bold",children:this.props.i18n._('Processing Video', 'Loading message shown while user video is uploading', 'Loading message shown while user video is uploading')}),(0,y.jsx)(o.xu,{paddingY:4,children:(0,y.jsx)(o.xH,{accessibilityLabel:this.props.i18n._('Video uploading', 'Loading spinner while video uploads', 'Loading spinner while video uploads'),show:!0})})]}),f,n&&this.renderImage()]})}),(n||u)&&(void 0===d||d)&&i&&this.renderResetButton()]})}},{key:"render",value:function(){var e=this.props,t=e.connectDropTarget,n=e.height,r=e.imagePreviewSrc,i=e.onClick,a=e.videoUrls,l=e.width,s=e.hoverHandlers,c=s.onMouseOver,u=s.onMouseLeave,d=this.isPin?"auto":n,p=(0,y.jsxs)(o.xu,{position:"relative",children:[(0,y.jsx)(m.Z,{unsafeCSS:S}),this.renderProgressBar(),r||a?(0,y.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{border:this.isPin?0:"2px dashed #767676",borderRadius:"10px",outline:"none"}},height:d,marginEnd:"auto",marginStart:"auto",padding:0,width:l,children:(0,y.jsx)(o.iP,{fullWidth:!1,mouseCursor:r?"default":"pointer",onMouseEnter:c,onMouseLeave:u,children:this.renderContent()})}):(0,y.jsx)(o.iP,{onMouseEnter:c,onMouseLeave:u,onTap:i,children:(0,y.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{border:this.isPin?0:"2px dashed #767676",borderRadius:"10px",cursor:r?"default":"pointer",outline:"none"}},height:d,marginEnd:"auto",marginStart:"auto",padding:0,width:l,children:this.renderContent()})})]});return t((0,y.jsx)("div",{children:p}))}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}(a.prototype,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(r.Component),I=(0,p.GR)(function(e){return e.accepts},{drop:function(e,t){e.onDrop&&e.onDrop(e,t)}},function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()}})(function(e){var t=(0,h.ZP)(),n=(0,g.Z)(),r=n.isHovering,o=n.hoverHandlers;return(0,y.jsx)(A,v(v({},e),{},{hoverHandlers:o,i18n:t,isHovering:r}))}),T=n(397657),D=n(174646);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach(function(t){B(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function R(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){M(i,r,o,a,l,"next",e)}function l(e){M(i,r,o,a,l,"throw",e)}a(void 0)})}}function L(e,t){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function U(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(H=function(){return!!e})()}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t,n){return(t=F(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e){var t=function(e,t){if("object"!=E(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=E(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==E(t)?t:t+""}var N=["video/quicktime","video/mp4"],V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1200x";return e&&"https://i.pinimg.com/".concat(t,"/").concat(e.substring(0,2),"/").concat(e.substring(2,4),"/").concat(e.substring(4,6),"/").concat(e,".jpg")||""},Y=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&L(a,e);var t,n,r,i=(t=H(),function(){var e,n=Z(a);return e=t?Reflect.construct(n,arguments,Z(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==E(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return U(e)}(this,e)});function a(){var e,t;if(!(this instanceof a))throw TypeError("Cannot call a class as a function");for(var n=arguments.length,r=Array(n),l=0;l<n;l++)r[l]=arguments[l];return B(U(e=i.call.apply(i,[this].concat(r))),"state",{imagePreviewSrc:e.props.existingImageSrc||"",isVideo:!1,isVideoComplete:!1,thumbnail:null,videoUrls:null,errorFlyout:null,progress:0}),B(U(e),"mounted",!1),B(U(e),"containerRef",null),B(U(e),"fileInputRef",null),B(U(e),"xhr",null),B(U(e),"CHECK_VIDEO_TIMEOUT",null),B(U(e),"ERROR_MESSAGE",e.props.i18n._('Unable to upload video. Please try again later.', 'Error shown when we can\'t accept video uploads', 'Error shown when we can\'t accept video uploads')),B(U(e),"handleFileDrop",function(t,n){if(n&&(!e.xhr||4===e.xhr.readyState)){var r=n.getItem().files[0];e.handleFile(r)}}),B(U(e),"handleFile",function(t){var n=e.props.onImageUploadStart;t.size>2e9?e.showError(e.props.i18n._('The video is too large. The maximum size is 2 GB.', 'Error if a user tries to upload a video that is too large', 'Error if a user tries to upload a video that is too large')):(e.props.allowVideo&&N.includes(t.type)&&e.setState({isVideo:!0}),e.loadMedia(t),n&&n())}),B(U(e),"showError",function(t){var n=(0,y.jsx)(o.J2,{anchor:e.containerRef,idealDirection:e.props.idealErrorDirection,onDismiss:function(){return e.setState({errorFlyout:null})},shouldFocus:!1,size:"sm",children:(0,y.jsx)(o.xu,{padding:3,children:(0,y.jsx)(o.qb,{title:t,type:"problem"})})});e.removePreview(n)}),B(U(e),"openFileDialog",function(){e.state.imagePreviewSrc||e.state.isVideo||(e.props.logContextEvent({event_type:101,component:192,element:1156}),e.fileInputRef&&e.fileInputRef.click())}),B(U(e),"openFile",function(t){var n=t.target.files[0];e.handleFile(n)}),B(U(e),"removePreview",function(t){e.setState({imagePreviewSrc:"",progress:0,isVideo:!1,isVideoComplete:!1,videoUrls:null,errorFlyout:t}),e.fileInputRef&&(e.fileInputRef.value=""),e.xhr&&e.xhr.abort&&(e.xhr.abort(),e.xhr=null),e.CHECK_VIDEO_TIMEOUT&&clearTimeout(e.CHECK_VIDEO_TIMEOUT),e.props.onReset&&e.props.onReset()}),B(U(e),"checkForMedia",(t=R(regeneratorRuntime.mark(function t(n){var r,o,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.Z.create("VIPResource",{upload_ids:[n]}).callGet();case 2:(r=t.sent).resource_response&&r.resource_response.data&&r.resource_response.data[n]?(i=(o=r.resource_response.data[n]).status,a=o.signature,"processing"===i||"registered"===i?e.CHECK_VIDEO_TIMEOUT=setTimeout(function(){return e.checkForMedia(n)},1e3):"succeeded"===i?e.handleMediaUploadSuccess(a,n):e.showError(e.ERROR_MESSAGE)):e.showError(e.ERROR_MESSAGE);case 4:case"end":return t.stop()}},t)})),function(e){return t.apply(this,arguments)})),B(U(e),"loadMedia",function(t){var n=e.state.isVideo;d.Z.create("VIPResource",{type:n?"video":"triedit-image"}).callCreate().then(function(n){var r,o=null!=(r=n.resource_response.data)?r:{},i=o.upload_id,a=o.upload_url,l=o.upload_parameters;e.uploadMedia(t,i,a,l)},function(){e.showError(e.ERROR_MESSAGE)})}),B(U(e),"uploadMedia",function(t,n,r,o){var i=e.state.isVideo,a=new XMLHttpRequest;a.open("POST",r,!0),a.onload=function(){var t;(t=a.status)>=200&&t<400?e.setState({errorFlyout:null,isVideoComplete:i}):e.showError(e.props.i18n._('Something went wrong. Please try again later.', 'Error if video fails to upload', 'Error if video fails to upload')),e.checkForMedia(n)},a.upload.onprogress=function(t){var n=Math.round(99*t.loaded/t.total);e.setState({progress:n})};var l=new FormData;for(var s in o)l.append(s,o[s]);l.append("file",t),a.send(l),e.xhr=a}),e}return r=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"handleMediaUploadSuccess",value:(n=R(regeneratorRuntime.mark(function e(t,n){var r,o,i,a,l,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.state.isVideo,i=(o=this.props).width,a=o.height,!r){e.next=12;break}if(this.props.isAuthenticated){e.next=6;break}return this.showError(this.ERROR_MESSAGE),e.abrupt("return");case 6:return e.next=8,(0,T.Z)({url:"/v3/videos/urls/",data:{signatures:[t]}});case 8:l=e.sent,this.handleVideoUploadSuccess(l,t,n),e.next=15;break;case 12:s=V(t),this.setState({imagePreviewSrc:s,progress:100}),this.props.onImageUploadFinished({image:{url:s,width:i,height:a}});case 15:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"handleVideoUploadSuccess",value:function(e,t,n){var r=this;if(this.mounted){var o=e.resource_response.data,i="https://i.pinimg.com/".concat(o[t].metadata.thumbnail),a=o[t].urls;this.setState({videoUrls:a,thumbnail:i,progress:100});var l=new XMLHttpRequest;l.onload=function(){var e=new FileReader;e.readAsDataURL(l.response),e.onloadend=function(){var t;r.props.onImageUploadFinished({video:{uploadId:n,imageBase64:null!=(t=e.result)?t:""}})}},l.open("GET",i),l.responseType="blob",l.send()}}},{key:"render",value:function(){var e=this,t=u.hm.FILE,n=this.state,r=n.errorFlyout,i=n.imagePreviewSrc,a=n.isVideo,l=n.isVideoComplete,s=n.progress,c=n.thumbnail,d=n.videoUrls,p=this.props,f=p.allowReset,h=p.allowVideo,m=p.display,g=p.height,_=p.width;return(0,y.jsxs)(o.xu,{ref:function(t){e.containerRef=t},children:[(0,y.jsx)(o.xu,{display:"visuallyHidden",children:(0,y.jsx)("input",{ref:function(t){e.fileInputRef=t},accept:h?"image/*,video/mp4,video/quicktime":"image/*","data-gestalt-valid-html":"TextField",onChange:this.openFile,type:"file"})}),(0,y.jsx)(I,{accepts:[t],allowReset:f,display:m,handleRemoveClick:this.removePreview,height:g,imagePreviewSrc:i,isVideo:a,isVideoComplete:l,onClick:this.openFileDialog,onDrop:this.handleFileDrop,progress:s,thumbnail:c,videoUrls:d,width:_}),r]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,F(r.key),r)}}(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),a}(r.Component);B(Y,"defaultProps",{onImageUploadStart:function(){}});var K=function(e){var t=(0,c.v)().logContextEvent,n=(0,D.B)().isAuthenticated,r=(0,h.ZP)();return(0,y.jsx)(Y,z(z({},e),{},{i18n:r,isAuthenticated:n,logContextEvent:t}))},G=n(81772),W=n(231333),q=n(339908),X=n(617100),J=n(486738);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach(function(t){ei(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function et(e,t){return(et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function en(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function er(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(er=function(){return!!e})()}function eo(e){return(eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ei(e,t,n){return(t=ea(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ea(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}var el=/#[^(. #,\/$%\^&\*;:{}=\`~()\[\]@|<>)]*$/,es=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&et(i,e);var t,n,r=(t=er(),function(){var e,n=eo(i);return e=t?Reflect.construct(n,arguments,eo(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return en(e)}(this,e)});function i(e){if(!(this instanceof i))throw TypeError("Cannot call a class as a function");ei(en(t=r.call(this,e)),"setTextAreaRef",function(e){t._textAreaRef=e}),ei(en(t),"handleTextInputChange",function(e){var n=e.value;t.setState({notes:n.substring(0,1e3)}),n.length>1e3?t.forceUpdate():t.handleHashtagTypeahead(n)}),ei(en(t),"handleHashtagTypeahead",function(e){var n=el.exec(e),r=n?n[0]:"";!t.state.inTypeahead&&r?t.setState({inTypeahead:!0,typeaheadValue:r}):t.state.inTypeahead&&(r?t.setState({typeaheadValue:r}):t.setState({inTypeahead:!1,typeaheadValue:""}))}),ei(en(t),"addHashtag",function(e){t.setState(function(t){return{inTypeahead:!1,notes:t.notes.replace(el,e),typeaheadValue:""}})}),ei(en(t),"uploadImageAndCreateDidIt",function(){(0,T.Z)({url:"/v3/did_it/image/upload/",method:"PUT",data:{image_url:t.state.imageUrlToSend}}).then(function(e){var n=e.resource_response.data.image_signature;return t.createUpdateDidIt(n)}).catch(function(){return t.createUpdateDidIt()})}),ei(en(t),"handleImageReset",function(){return t.setState({imageUrlToSend:null})}),ei(en(t),"handleFinishImageUpload",function(e){e.image&&t.setState({imageUrlToSend:e.image.url})}),ei(en(t),"handleDoneClick",function(){var e=t.props,n=e.pinId;(0,e.logContextEvent)({event_type:101,view_type:101,component:192,element:1112,object_id_str:n}),t.setState({submitted:!0}),t.handleDoneSubmission()}),ei(en(t),"handleDoneSubmission",function(){var e=t.state.imageUrlToSend,n=t.props.pinActivity;if(e){if(!n||e!==n.oldImageUrl)return t.uploadImageAndCreateDidIt();else if(n.imageSignatures&&n.imageSignatures.length>0)return t.createUpdateDidIt(n.imageSignatures[0])}return t.createUpdateDidIt()}),ei(en(t),"handleCancel",function(){var e=t.props.onDoneStateChanged;e&&e(!1)}),ei(en(t),"handleDeleteConfirmation",function(e){var n=t.props,r=n.aggregatedPinDataId,o=n.deleteUserDidItData,i=n.isDoneByMe,a=n.loggedInUser.username,l=n.onDoneStateChanged,s=n.pinId,c=n.logContextEvent;t.setState({showDeleteModal:!1}),e&&(c({event_type:101,view_type:101,component:192,element:1264,object_id_str:s}),o({aggregatedPinDataId:r,pinId:s,username:a,id:e,isOwnedByMe:!0}),l&&l(i))}),ei(en(t),"handleShowDeleteModal",function(){return t.setState({showDeleteModal:!0})});var t,n=e.pinActivity;return t.state={id:(null==n?void 0:n.id)||null,imageUrlToSend:(null==n?void 0:n.oldImageUrl)||null,inTypeahead:!1,notes:(null==n?void 0:n.notes)||"",showDeleteModal:!1,submitted:!1,typeaheadValue:""},t}return n=[{key:"createUpdateDidIt",value:function(e){var t=this,n=this.props,r=n.aggregatedPinDataId,o=n.createUserDidItData,i=n.isDoneByMe,a=n.loggedInUser.username,l=n.onDoneStateChanged,s=n.pinId,c=n.toastManagerContext,u=n.updateUserDidItData,d=this.state,p=d.id,f=d.notes;f&&(i?p&&u({id:p,pinId:s,details:f,image_signatures:e?[e]:[]}):o({aggregatedPinDataId:r,username:a,details:f,image_signatures:e?[e]:[],pin_id:s}),l&&l(!i),-1===window.location.href.indexOf(a+"/tried")&&c.showToast(function(e){var n=e.hideToast;return(0,y.jsx)(W.Z,{duration:3e3,href:"/".concat(a,"/tried/"),onHide:n,text:t.props.i18n._('Nice work! Pins you\'ve tried live on your profile', 'Congratulations after trying a pin', 'Congratulations after trying a pin')})}))}},{key:"render",value:function(){var e=this.state,t=e.imageUrlToSend,n=e.notes,r=e.showDeleteModal,i=e.submitted,a=this.props,l=a.isDoneByMe,c=a.pinActivity,u=!!t&&(c||{}).oldImageUrl!==t,d=!!t,p=c&&c.notes!==n,f=!!n&&""!==n.trim();return(0,y.jsxs)(o.xu,{children:[(0,y.jsx)(o.xu,{marginTop:4,paddingX:12,children:(0,y.jsx)(o.xu,{column:12,children:(0,y.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{transition:"padding-top 0.2s ease"}},paddingY:10*!t,children:(0,y.jsx)(o.xu,{alignItems:"center",color:"transparent",column:12,display:"flex",justifyContent:"center",marginBottom:2,rounding:2,children:(0,y.jsx)(K,{display:"image",existingImageSrc:t,height:366,idealErrorDirection:"up",onImageUploadFinished:this.handleFinishImageUpload,onReset:this.handleImageReset,width:366})})})})}),(0,y.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{transition:"opacity 0.2s ease",transitionDelay:"0.2s",visibility:t?"visible":"hidden"}},height:t?"auto":0,opacity:+!!t,children:(0,y.jsxs)(o.xu,{margin:3,marginEnd:"auto",marginStart:"auto",width:366,children:[(0,y.jsx)(o.xu,{ref:this.setTextAreaRef,children:(0,y.jsx)(o.Kx,{id:"trynotes",onChange:this.handleTextInputChange,placeholder:this.props.i18n._('Add a note or tip', 'Tip input for tried it', 'Tip input for tried it'),value:n})}),this.state.inTypeahead&&this._textAreaRef?(0,y.jsx)(J.Z,{addHashtag:this.addHashtag,anchor:this._textAreaRef,idealDirection:"up",query:this.state.typeaheadValue}):null,n.length>900&&(0,y.jsx)(o.xu,{paddingY:1,children:(0,y.jsxs)(o.xv,{align:"end",size:"200",children:[" ",n.length,"/",1e3," "]})})]})}),(0,y.jsxs)(o.kC,{alignItems:"stretch",justifyContent:"end",children:[r&&(0,y.jsx)(s.Z,{didItData:c,onDeleteConfirmation:this.handleDeleteConfirmation}),i?(0,y.jsx)(o.xu,{marginEnd:2,children:(0,y.jsx)(o.xH,{accessibilityLabel:this.props.i18n._('submit', 'accessible label for loading spinner on submit button', 'accessible label for loading spinner on submit button'),show:!0})}):null,(0,y.jsxs)(o.xu,{display:"flex",marginBottom:3,marginEnd:4,children:[l?(0,y.jsx)(o.xu,{marginEnd:1,children:(0,y.jsx)(o.zx,{onClick:this.handleShowDeleteModal,size:"md",text:this.props.i18n._('Delete', 'delete button in modal for tried-it info', 'delete button in modal for tried-it info')})}):(0,y.jsx)(o.xu,{marginEnd:1,children:(0,y.jsx)(o.zx,{onClick:this.handleCancel,size:"md",text:this.props.i18n._('Cancel', 'cancel button in modal for tried-it info', 'cancel button in modal for tried-it info')})}),(0,y.jsx)(o.xu,{children:(0,y.jsx)(o.zx,{color:"red",disabled:!d||!f||!p&&!u,onClick:this.handleDoneClick,size:"md",text:this.props.i18n._('Done', 'done button in modal for tried-it info', 'done button in modal for tried-it info')})})]})]})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ea(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(r.PureComponent),ec=(0,G.Z)(function(e){var t=(0,c.v)().logContextEvent,n=(0,h.ZP)(),r=(0,a.I0)(),o=(0,l.bindActionCreators)(X.DD,r),i=(0,l.bindActionCreators)(X.lg,r),s=(0,l.bindActionCreators)(X.IU,r);return(0,y.jsx)(es,ee(ee({},e),{},{createUserDidItData:o,deleteUserDidItData:i,i18n:n,logContextEvent:t,toastManagerContext:(0,q.F9)(),updateUserDidItData:s}))}),eu=n(113474),ed=["onDoneStateChanged","pinActivityResource","pinTitle","userDidItDataId"];function ep(e){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ef(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ef(Object(n),!0).forEach(function(t){eb(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ef(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function em(e,t){return(em=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eg(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ey(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ey=function(){return!!e})()}function e_(e){return(e_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eb(e,t,n){return(t=ev(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ev(e){var t=function(e,t){if("object"!=ep(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ep(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ep(t)?t:t+""}var ex=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&em(a,e);var t,n,r=(t=ey(),function(){var e,n=e_(a);return e=t?Reflect.construct(n,arguments,e_(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==ep(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return eg(e)}(this,e)});function a(){var e;if(!(this instanceof a))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return eb(eg(e=r.call.apply(r,[this].concat(n))),"onDoneStateChanged",function(t){var n=e.props,r=n.onDoneStateChanged,o=n.pinActivityResource;r&&r(t),t&&o&&o.refresh&&o.refresh()}),e}return n=[{key:"render",value:function(){var e=this.props,t=(e.onDoneStateChanged,e.pinActivityResource),n=(e.pinTitle,e.userDidItDataId,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,ed));return!t||t&&t.isLoaded?(0,y.jsx)(o.xu,{rounding:2,children:(0,y.jsx)(ec,eh({onDoneStateChanged:this.onDoneStateChanged,pinActivity:function(e){if(!e)return null;var t=e.details,n=e.images,r=e.image_signatures;return{id:e.id,imageSignatures:r,notes:t,oldImageUrl:n[0]["200x"].url}}(t&&t.data)},n))}):(0,y.jsx)(i.Z,{})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ev(r.key),r)}}(a.prototype,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(r.Component);function ej(e){var t=(0,eu.Z)({name:"DidItUserPinActivityResource",options:{aggregated_pin_data_id:e.aggregatedPinDataId,username:"me"},noCache:!0});return(0,y.jsx)(ex,eh(eh({},e),{},{pinActivityResource:t}))}function eP(e){var t=(0,eu.Z)({name:"DidItActivityResource",options:{user_did_it_data_id:e.userDidItDataId,username:"me"},noCache:!0});return(0,y.jsx)(ex,eh(eh({},e),{},{pinActivityResource:t}))}function eO(e){return e.isDoneByMe&&e.userDidItDataId?(0,y.jsx)(eP,eh({},e)):e.isDoneByMe?(0,y.jsx)(ej,eh({},e)):(0,y.jsx)(ex,eh({},e))}var ew=n(852015),eC=n(522539);function eS(e){return(eS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eI(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eA(Object(n),!0).forEach(function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!=eS(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eS(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eS(t)?t:t+""}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eT=function(e){if(!e)return null;var t=e.richMetadata.title;return t?eI(eI({},e),{},{title:t}):null},eD=n(50865),eE=n(257159);function ek(e){return(ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ez(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eM(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ez(Object(n),!0).forEach(function(t){var r,o,i;r=e,o=t,i=n[t],(o=eR(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ez(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eR(e){var t=function(e,t){if("object"!=ek(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ek(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ek(t)?t:t+""}function eL(e,t){return(eL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eU(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eU=function(){return!!e})()}function eH(e){return(eH=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eZ=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");a.prototype=Object.create(e&&e.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),e&&eL(a,e);var t,n,r=(t=eU(),function(){var e,n=eH(a);return e=t?Reflect.construct(n,arguments,eH(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==ek(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");var n=e;if(void 0===n)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(this,e)});function a(){if(!(this instanceof a))throw TypeError("Cannot call a class as a function");return r.apply(this,arguments)}return n=[{key:"render",value:function(){var e=this.props,t=e.aggregatedPinDataId,n=e.isDoneByMe,r=e.loggedInUser,a=e.onDoneStateChanged,l=e.onHide,s=e.pinId,c=e.pinResource,u=e.pinTitle,d=e.userDidItDataId;if(!c.isLoaded)return(0,y.jsx)(i.Z,{});var p=(eT((0,eC.Z)((0,eD.Z)({pin:c.data})))||{}).title,f=u||p?(0,eE.Z)(this.props.i18n._('Add a photo of {{pinTitle}}', 'Adding photo of a pin', 'Adding photo of a pin'),{pinTitle:u||p||""}):this.props.i18n._('Add a photo', 'Adding a photo', 'Adding a photo');return(0,y.jsx)(ew.ZP,{accessibilityModalLabel:f,heading:f,onDismiss:l,size:500,children:(0,y.jsx)(o.xu,{color:"default",display:"flex",justifyContent:"center",rounding:2,children:(0,y.jsx)(eO,{aggregatedPinDataId:t,isDoneByMe:n,loggedInUser:r,onDoneStateChanged:a,pinId:s,pinTitle:u||p,userDidItDataId:d})})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eR(r.key),r)}}(a.prototype,n),Object.defineProperty(a,"prototype",{writable:!1}),a}(r.PureComponent);function eB(e){var t=(0,h.ZP)(),n=(0,eu.Z)({name:"PinResource",options:{field_set_key:"detailed",id:e.pinId}});return(0,y.jsx)(eZ,eM(eM({},e),{},{i18n:t,pinResource:n}))}var eF=n(135376);function eN(e){return(eN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eV(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eY(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eV(Object(n),!0).forEach(function(t){eX(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eV(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eK(e,t){return(eK=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eG(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(eW=function(){return!!e})()}function eq(e){return(eq=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eX(e,t,n){return(t=eJ(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function eJ(e){var t=function(e,t){if("object"!=eN(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eN(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eN(t)?t:t+""}var e$=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&eK(i,e);var t,n,o=(t=eW(),function(){var e,n=eq(i);return e=t?Reflect.construct(n,arguments,eq(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==eN(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return eG(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return eX(eG(e=o.call.apply(o,[this].concat(n))),"state",{showModal:!1}),eX(eG(e),"onTriedItButtonClick",function(t){var n=e.props,r=n.requireAuth,o=n.logContextEvent;if(t&&t.stopPropagation(),r)return void r();e.handleModalStateChange(!0),o({event_type:101,view_type:101,component:e.props.thriftComponentType,element:1141,object_id_str:e.props.pinId,aux_data:{is_create:!e.props.isDoneByMe}})}),eX(eG(e),"handleHideModal",function(){e.handleModalStateChange(!1),e.props.logContextEvent({event_type:101,view_type:101,component:192,element:75,object_id_str:e.props.pinId})}),eX(eG(e),"onModalDoneStateChanged",function(t){e.handleModalStateChange(!1,t)}),eX(eG(e),"handleModalStateChange",function(t,n){var r=e.props,o=r.onDoneStateChanged,i=r.onToggleModal;e.setState({showModal:t},function(){!t&&o&&o("boolean"==typeof n&&n),i&&i(t)})}),e}return n=[{key:"render",value:function(){var e=this.props,t=e.aggregatedPinDataId,n=e.isDoneByMe,o=e.loggedInUser,i=e.pinId,a=e.pinTitle,l=e.userDidItDataId;return(0,y.jsxs)(r.Fragment,{children:[this.props.children({onTriedItButtonClick:this.onTriedItButtonClick}),this.state.showModal?(0,y.jsx)(eB,{aggregatedPinDataId:void 0===t?"":t,isDoneByMe:void 0!==n&&n,loggedInUser:void 0===o?{id:"",username:""}:o,onDoneStateChanged:this.onModalDoneStateChanged,onHide:this.handleHideModal,pinId:void 0===i?"":i,pinTitle:null!=a?a:"",userDidItDataId:l}):null]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,eJ(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(r.PureComponent);function eQ(e){var t=(0,c.v)().logContextEvent,n=(0,eF.Z)();return(0,y.jsx)(e$,eY(eY({},e),{},{logContextEvent:t,requireAuth:n}))}},87134:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(132227),o=n(852015),i=n(233846),a=n(19035);function l(e){var t=e.onDeleteConfirmation,n=e.didItData,l=(0,i.ZP)(),s=n&&n.id,c=l._('Are you sure?', 'Confirmation dialog for deleting data', 'Confirmation dialog for deleting data');return(0,a.jsx)(o.ZP,{accessibilityModalLabel:l._('Are you sure you want to delete the did it photo?', 'Label for a modal showing to confirm deleting a did it photo', 'Label for a modal showing to confirm deleting a did it photo'),footer:(0,a.jsxs)(r.xu,{display:"flex",justifyContent:"end",marginEnd:-1,marginStart:-1,children:[(0,a.jsx)(r.xu,{padding:1,children:(0,a.jsx)(r.zx,{fullWidth:!0,onClick:function(){return t(null)},size:"lg",text:l._('Cancel', 'Cancel the deleting data in a modal form', 'Cancel the deleting data in a modal form')})}),(0,a.jsx)(r.xu,{padding:1,children:(0,a.jsx)(r.zx,{color:"red",dataTestId:"delete-did-it-button",fullWidth:!0,onClick:function(){t(s)},size:"lg",text:l._('Delete', 'Confirmation of deleting data', 'Confirmation of deleting data')})})]}),heading:c,onDismiss:function(){return t(null)},role:"alertdialog",size:"sm",children:(0,a.jsx)(r.xu,{paddingX:4,paddingY:2,children:(0,a.jsx)(r.xv,{children:l._('This will remove this photo', 'Confirmation dialog for deleting data', 'Confirmation dialog for deleting data')})})})}},115157:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(132227),o=n(233846),i=n(19035);function a(){var e=(0,o.ZP)();return(0,i.jsx)(r.xu,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{outline:"none"}},display:"flex",height:155,justifyContent:"center",rounding:2,width:300,children:(0,i.jsx)(r.xH,{accessibilityLabel:e._('Tried it', ' - ', ' -- '),show:!0})})}},1450:function(e,t,n){n.d(t,{Z:function(){return ts}});var r,o=n(258712),i=n(545007),a=n(766178),l=n(132227),s=n(166543),c=n(19035),u="__SafeLinkFlag__",d=function(e){var t=e.html,n=e.onClick||null,r=[],o=(t=(t=t||"").replace(/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>)]+/gi,function(e){return r.push({url:"/search/pins/?q=".concat(encodeURIComponent(e),"&rs=").concat(s.i.HASHTAG_CLOSEUP),text:e}),u})).replace(/<a[\s]+href=['"]([^'"<>]+)['"][^>]*>([^<]*)<\/a>/gi,function(e,t,n){return r.push({url:t,text:n}),u});return(0,c.jsx)(l.xu,{"data-test-id":"safe-link",children:o.split(new RegExp("(".concat(u,")"))).filter(function(e){return e.length>0}).map(function(e,t){var o=e;if(e===u&&r.length){var i=r.shift(),a=i.url,s=i.text;o=(0,c.jsx)(l.rU,{display:"inlineBlock",href:a,onClick:n||void 0,underline:"hover",children:s})}return(0,c.jsx)(l.xv,{color:"shopping",inline:!0,weight:"bold",children:o},t)})})};n(53583);var p=n(284987),f=n(909598),h=n(852015),m=function(e){var t=e.accessibilityModalLabel,n=e.cancelButtonText,r=e.confirmButtonText,o=e.detail,i=e.heading,a=e.onConfirm,s=e.onDismiss;return(0,c.jsx)(h.ZP,{accessibilityModalLabel:t,heading:i,onDismiss:s,size:"md",children:(0,c.jsxs)(l.xu,{children:[(0,c.jsx)(l.xu,{padding:4,children:(0,c.jsx)(l.xv,{children:o})}),(0,c.jsxs)(l.kC,{alignItems:"stretch",justifyContent:"end",children:[(0,c.jsx)(l.xu,{margin:2,children:(0,c.jsx)(l.xu,{"data-test-id":"confirm-modal-cancel",children:(0,c.jsx)(l.zx,{fullWidth:!0,onClick:s,text:n})})}),(0,c.jsx)(l.xu,{margin:2,children:(0,c.jsx)(l.xu,{"data-test-id":"confirm-modal-confirm",children:(0,c.jsx)(l.zx,{color:"red",fullWidth:!0,onClick:function(){a(),s()},text:r})})})]})]})})},g=n(233846),y=n(970601);function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var b=(0,o.forwardRef)(function(e,t){var n,r=e.isCloseup,i=e.isEmojiTrayOpen,a=e.onClick,s=function(e){if(Array.isArray(e))return e}(n=(0,o.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{i=(n=n.call(e)).next,!1;for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(n,2)||function(e,t){if(e){if("string"==typeof e)return _(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),u=s[0],d=s[1],p=(0,l.JZ)(),f=(0,g.ZP)(),h=(0,o.useRef)(null);(0,o.useEffect)(function(){t&&(t.current=h.current)},[t]);var m=function(){null==a||a()},b=f._('Select an emoji', 'emojitray.button.accessibilityLabel', 'Accessibility label for emoji tray button');return(0,c.jsx)(l.xu,{color:i?"secondary":"transparent","data-test-id":"emoji-selector",display:"flex",justifyContent:"center",rounding:"circle",children:void 0!==r&&r?(0,c.jsx)(l.xu,{ref:h,children:(0,c.jsx)(l.hU,{accessibilityLabel:b,icon:"face-smiley",iconColor:"darkGray",onClick:m,size:"lg"})}):(0,c.jsx)(l.iP,{ref:h,accessibilityLabel:b,fullWidth:!1,onMouseEnter:function(){d(!0)},onMouseLeave:function(){d(!1)},onTap:m,rounding:"circle",children:(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)(y.Z,{unsafeCSS:"@keyframes wiggle {\n        0% {transform: rotate(0deg);}\n        25% {transform: rotate(15deg);}\n        50% {transform: rotate(-15deg);}\n        75% {transform: rotate(15deg);}\n        100% {transform: rotate(0deg);}\n      }"}),(0,c.jsx)(l.xu,{ref:t,alignItems:"center",dangerouslySetInlineStyle:{__style:u&&!p?{fontSize:"24px",animationName:"wiggle",animationDuration:"0.9s"}:{fontSize:"24px"}},display:"flex",height:40,justifyContent:"center",width:40,children:"\uD83D\uDE03"})]})})})}),v=n(19963),x=n(81772),j=n(882368),P=n(644849),O=n(418579),w=n(332245);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach(function(t){z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function D(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(E=function(){return!!e})()}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e){var t=function(e,t){if("object"!=C(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=C(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==C(t)?t:t+""}var R={isTextChanged:!1,showConfirmDiscardModal:!1,submissionInProgress:!1,textValue:"",userMentionOverLimitError:!1},L=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&T(o,e);var t,n,r=(t=E(),function(){var e,n=k(o);return e=t?Reflect.construct(n,arguments,k(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==C(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return D(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return z(D(e=r.call.apply(r,[this].concat(n))),"state",I(I({},R),{},{tags:e.props.tags||[],textValue:e.props.text||"",isEmojiTrayOpen:!1})),z(D(e),"handleFocus",function(){e.props.onEnter()}),z(D(e),"handleChange",function(t){var n=t.text,r=t.mentions;r.length<e.state.tags.length&&e.props.logContextEvent({event_type:8906,aux_data:{tag_type:1}});var o=e.props.text||"";e.setState({isTextChanged:o!==n,textValue:n,tags:r,userMentionOverLimitError:r.length>5})}),z(D(e),"handleOnClickEdit",function(){var t=e.props.onEditItem,n=e.state,r={contentMarkdown:n.textValue,imageSignatures:"",objectIds:[],tags:JSON.stringify(n.tags)};t&&t(r),e.setState({submissionInProgress:!1})}),z(D(e),"handleOnClickPost",function(){e.state.userMentionOverLimitError||(e.setState({submissionInProgress:!0,isEmojiTrayOpen:!1}),e.handleOnClickPostFinal())}),z(D(e),"handleOnClickPostFinal",function(){var t=e.props.onAddItem,n=e.state,r={contentMarkdown:n.textValue,imageSignatures:"",objectIds:[],tags:JSON.stringify(n.tags)};t&&t(r),e.setState(R)}),z(D(e),"handleOnFinalDiscardItem",function(){var t=e.props.onCancelItem;e.setState(R),t()}),z(D(e),"isSubmitEditDisabled",function(){return!e.state.isTextChanged}),z(D(e),"toggleShowConfirmDiscardModal",function(){var t=e.state.showConfirmDiscardModal;e.setState({showConfirmDiscardModal:!t,isEmojiTrayOpen:!1})}),z(D(e),"renderConfirmDiscardModal",function(){var t,n;return"textInFlightNested"===e.props.statusType?(t=e.props.i18n._('Your changes will be discarded', 'Confirmation dialog before discarding changes', 'Confirmation dialog before discarding changes'),n=e.props.i18n._('Discard changes', 'Clear edits', 'Clear edits')):(t=e.props.i18n._('Once you delete a draft, you can\u2019t undo it', 'Confirmation before discarding changes', 'Confirmation before discarding changes'),n=e.props.i18n._('Delete', 'delete draft of a post or comment', 'delete draft of a post or comment')),(0,c.jsx)(m,{accessibilityModalLabel:e.props.i18n._('Confirm discard composer', 'Confirm discarding a post or comment', 'Confirm discarding a post or comment'),cancelButtonText:e.props.i18n._('Cancel', 'Cancel discarding a post or comment', 'Cancel discarding a post or comment'),confirmButtonText:n,detail:t,heading:e.props.i18n._('Are you sure?', 'Confirm discarding a post or comment', 'Confirm discarding a post or comment'),onConfirm:e.handleOnFinalDiscardItem,onDismiss:e.toggleShowConfirmDiscardModal})}),z(D(e),"getReplyToEntity",function(e){return[e?"@".concat(e.user.username," "):"",e?[{offset:0,object_id:e.user.id,length:e.user.username.length+1,tag_type:1}]:[]]}),e}return n=[{key:"isAggregatedComment",get:function(){var e=this.props.objectType;return e===P.o.pin||e===P.o.didIt||e===P.o.aggregatedComment}},{key:"render",value:function(){var e,t,n,r=this,o=this.props,i=o.avatarSize,a=o.replyToObject,s=o.privatePin,u=o.statusType,d=o.viewingUser,p=this.state,h=p.isTextChanged,m=p.isEmojiTrayOpen,g=p.showConfirmDiscardModal,y=p.submissionInProgress,_=p.tags,v=p.textValue,x=p.userMentionOverLimitError,j=function(e){if(Array.isArray(e))return e}(e=this.getReplyToEntity(a))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{i=(n=n.call(e)).next,!1;for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,2)||function(e,t){if(e){if("string"==typeof e)return S(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),P=j[0],C=j[1],A=(0,c.jsx)(l.xu,{children:(0,c.jsx)(l.xv,{align:"end",color:"error",size:"100",children:(0,w.bl)(!1,this.props.i18n)})});return(t=this.isAggregatedComment&&s?this.props.i18n._('Add a public comment', 'Add a comment', 'Add a comment'):this.isAggregatedComment?this.props.i18n._('Add a comment', 'Prompt to add a comment', 'Prompt to add a comment'):this.props.i18n._('Reply', 'Adding text to a community comment', 'Adding text to a community comment'),n=this.isAggregatedComment?this.props.i18n._('Done', 'Post a top level comment on a pin or tried it', 'Post a top level comment on a pin or tried it'):this.props.i18n._('Reply', 'Posting a reply to a post or comment', 'Posting a reply to a post or comment'),"textInflightCreation"===u)?(0,c.jsxs)(l.xu,{column:12,display:"flex",justifyContent:"center",children:[(0,c.jsxs)(l.xu,{width:"100%",children:[(0,c.jsxs)(l.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,c.jsx)(l.xu,{marginEnd:2,children:(0,c.jsx)(f.Z,{size:i,userKey:{type:"deprecated",data:d}})}),(0,c.jsx)(l.xu,{borderStyle:"sm",flex:"grow",padding:3,rounding:4,children:(0,c.jsx)(O.Z,{focusOnMount:!0,initialMentions:C,initialText:P,onAddMention:function(){r.props.logContextEvent({event_type:8905,aux_data:{tag_type:1}})},onChange:this.handleChange,onSearchMentionCancel:function(){r.props.logContextEvent({event_type:8908,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:function(){r.props.logContextEvent({event_type:8907,aux_data:{tag_type:1}})},placeholder:t})})]}),x&&A,(0,c.jsxs)(l.xu,{display:"flex",justifyContent:"end",marginTop:4,children:[(0,c.jsx)(l.xu,{"data-test-id":"activity-item-create-cancel",children:(0,c.jsx)(l.zx,{color:"gray",onClick:h?this.toggleShowConfirmDiscardModal:this.handleOnFinalDiscardItem,text:this.props.i18n._('Cancel', 'Cancel making post or comment', 'Cancel making post or comment')})}),(0,c.jsx)(l.xu,{marginStart:2,children:(0,c.jsx)(l.xu,{"data-test-id":"activity-item-create-submit",children:(0,c.jsx)(l.zx,{color:"red",disabled:!h||y||!v.length,onClick:this.handleOnClickPost,text:n})})})]})]}),g&&this.renderConfirmDiscardModal()]}):"textInFlightNested"===u?(0,c.jsxs)(l.xu,{column:12,"data-test-id":"activity-item-create",display:"flex",justifyContent:"center",children:[(0,c.jsxs)(l.xu,{width:"100%",children:[(0,c.jsx)(l.kC,{alignItems:"stretch",justifyContent:"start",children:(0,c.jsx)(l.xu,{borderStyle:"sm",flex:"grow",padding:3,rounding:4,children:(0,c.jsx)(O.Z,{focusOnMount:!0,initialMentions:_,initialText:v,onAddMention:function(){r.props.logContextEvent({event_type:8905,aux_data:{tag_type:1}})},onChange:this.handleChange,onSearchMentionCancel:function(){r.props.logContextEvent({event_type:8908,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:function(){r.props.logContextEvent({event_type:8907,aux_data:{tag_type:1}})},placeholder:t})})}),x&&A,(0,c.jsxs)(l.xu,{display:"flex",justifyContent:"end",marginTop:4,children:[(0,c.jsx)(l.zx,{color:"gray",onClick:h?this.toggleShowConfirmDiscardModal:this.handleOnFinalDiscardItem,text:this.props.i18n._('Cancel', 'Cancel making post or comment', 'Cancel making post or comment')}),(0,c.jsx)(l.xu,{marginStart:2,children:(0,c.jsx)(l.zx,{color:"red",disabled:this.isSubmitEditDisabled()||y,onClick:this.handleOnClickEdit,text:this.props.i18n._('Save', 'comment save button', 'comment save button')})})]})]}),g&&this.renderConfirmDiscardModal()]}):(0,c.jsx)(l.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{cursor:"text"}},display:"flex",justifyContent:"between",rounding:2,children:(0,c.jsx)(l.iP,{"aria-label":this.props.i18n._('Add comment field', 'ActivityItemCreate.textbox.accessibilityLabel', 'Textbox for comment field.'),mouseCursor:"default",onKeyDown:this.handleFocus,onTap:this.handleFocus,tabIndex:0,children:(0,c.jsxs)(l.xu,{column:12,display:"flex",children:[(0,c.jsx)(l.xu,{width:48,children:(0,c.jsx)(f.Z,{size:i,userKey:{type:"deprecated",data:d}})}),(0,c.jsxs)(l.xu,{alignItems:"center",borderStyle:"sm",dangerouslySetInlineStyle:{__style:{borderRadius:"26px"}},display:"flex",height:48,marginStart:4,padding:4,width:"100%",children:[(0,c.jsx)("textarea",{"data-gestalt-valid-html":"TextArea","data-test-id":"communityItemTextBox",maxLength:2e3,name:"communityItemTextBox",onFocus:this.handleFocus,placeholder:t,rows:1,style:{background:"transparent",border:"0",display:h?"inline-block":"block",minHeight:"textStaticDisplay"===u?"":"50px",fontSize:"16px",outline:"0",overflowX:"hidden",resize:"none",whiteSpace:"pre-wrap",width:"100%"}}),(0,c.jsx)(b,{isEmojiTrayOpen:m,onClick:function(){r.setState({isEmojiTrayOpen:!m})}})]})]})})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,M(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(o.Component);z(L,"defaultProps",{imageSignature:"",onEnter:function(){},text:"",widthAuto:!1});var U=(0,x.Z)(function(e){var t=(0,v.v)().logContextEvent,n=(0,g.ZP)(),r=(0,j.Z)(),o=r.isAuth?{image_medium_url:r.imageMediumUrl,type:"user",username:r.username,full_name:r.fullName,first_name:"",id:""}:{id:"",type:"user",username:""};return(0,c.jsx)(L,I(I({},e),{},{i18n:n,logContextEvent:t,viewingUser:o}))}),H=n(504122),Z=n(776682),B=n(254377),F=n(757653);function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){return(V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Y(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(K=function(){return!!e})()}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t,n){return(t=q(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e){var t=function(e,t){if("object"!=N(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=N(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==N(t)?t:t+""}var X=(0,F.Z)(function(){return Promise.all([n.e(88248),n.e(28164)]).then(n.bind(n,130035))},void 0,function(e){return 130035},"app-common-react-components-Activities-Utils-Linkify"),J=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&V(o,e);var t,n,r=(t=K(),function(){var e,n=G(o);return e=t?Reflect.construct(n,arguments,G(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==N(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return Y(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return W(Y(e=r.call.apply(r,[this].concat(n))),"parseText",function(){var t=e.props,n=t.tags,r=t.taggedUsers,o=t.text,i=t.size;if(!n.length||!r||n.length!==r.length)return e.renderRegularText(o,"1");var a=0,s=[];return n.forEach(function(t,n){var r=o.substring(a,t.offset);a=t.offset+t.length;var i=o.substring(t.offset,a);s=s.concat(e.renderRegularText(r,"".concat(n,"a"))).concat(e.renderTaggedText(i,n,"".concat(n,"b")))}),s=s.concat(e.renderRegularText(o.substring(a),"2")),(0,c.jsx)(l.xv,{inline:!0,overflow:"normal",size:i,children:s})}),W(Y(e),"renderRegularText",function(t,n){return(0,c.jsx)(l.xv,{inline:!0,overflow:"normal",size:e.props.size,children:e.props.allowLink?(0,c.jsx)(X,{children:t}):t},n)}),W(Y(e),"renderTaggedText",function(t,n,r){return(0,c.jsx)(l.xv,{color:"shopping",inline:!0,overflow:"normal",size:e.props.size,weight:"bold",children:(0,c.jsx)(l.rU,{display:"inlineBlock",href:"/".concat(e.props.taggedUsers[n].username),underline:"hover",children:t})},r)}),e}return n=[{key:"render",value:function(){return(0,c.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-wrap",wordWrap:"break-word"}},children:this.parseText()})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,q(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(o.PureComponent);W(J,"defaultProps",{allowLink:!0,size:"200"});var $=n(80118),Q=n(951016),ee=n(660691);function et(e){var t=e.createdAt,n=e.user,r=e.isHighlighted,o=(0,g.ZP)(),i=(0,ee.Z)(),a=(0,c.jsx)(l.xv,{color:"subtle",size:"200",children:(0,Q.A7)(t,o,i)}),s=(0,c.jsxs)(l.xv,{color:"subtle",size:"200",children:["\xb7 ",o._('Highlighted', 'pin.comments.highlight', 'Identifier for highlighted comments')]});return(0,c.jsxs)(l.xu,{alignItems:"start",display:"flex",marginEnd:-1,marginStart:-1,children:[(0,c.jsx)(l.xu,{paddingX:1,children:(0,c.jsx)(l.xv,{size:"200",weight:"bold",children:(0,c.jsx)(l.rU,{href:"/".concat(n.username,"/"),children:(0,Q.YD)(n)})})}),(0,c.jsx)(l.xu,{paddingX:1,children:a}),r&&(0,c.jsx)(l.xu,{paddingX:1,children:s})]})}var en=n(450745),er=n(113474),eo=n(181710),ei=n(59784),ea=n(140042),el=n(242490);function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ec(e){var t,n=e.avatarSize,r=e.commentCount,i=e.contentImageSignature,a=e.contentText,s=e.flyout,u=e.handleOnEditCancel,d=e.handleOnEdited,p=e.handleHelpfulClick,h=e.handleLikeClick,m=e.handleReplyClick,y=e.handleReplyCountClick,_=e.helpfulCount,b=e.hideAddObjects,v=e.hideReplyCount,x=e.inEditMode,j=e.isHighlighted,P=e.isLikedByMe,O=e.isMarkedHelpfulByMe,w=e.isPlainComment,C=e.parentObject,S=e.reactionCounts,A=e.responsePinId,I=e.slotIndex,T=e.taggedUsers,D=e.tags,E=e.truncateText,k=e.commentId,z=e.createdAt,M=e.commentAuthor,R=e.type,L=e.isORBACProfileManager,H=(0,en.K)(),Z=(0,g.ZP)(),F=function(e){if(Array.isArray(e))return e}(t=(0,o.useState)(k===H))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{i=(n=n.call(e)).next,!1;for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,2)||function(e,t){if(e){if("string"==typeof e)return es(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?es(e,t):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),N=F[0],V=F[1],Y=(0,er.Z)(A?{name:"PinResource",options:{id:A,field_set_key:"detailed"}}:null),K=Y.isLoaded,G=Y.data;(0,o.useEffect)(function(){k===H&&B.Z.setTimeout(function(){V(!1)},1500)},[]);var W=K&&!!A;return(0,c.jsx)(l.xu,{"data-test-id":"canonical-comment",children:(0,c.jsxs)(l.xu,{display:"flex",marginBottom:4*!!w,children:[(0,c.jsx)(l.xu,{marginEnd:2,children:(0,c.jsx)(f.Z,{size:void 0===n?"sm":n,userKey:{type:"deprecated",data:M}})}),(0,c.jsxs)(l.xu,{flex:"grow",marginStart:2,children:[(0,c.jsx)(l.xu,{borderStyle:"sm",dangerouslySetInlineStyle:{__style:{borderColor:x?"transparent":void 0,transition:"".concat(1e3,"ms"),backgroundColor:N?"lightGray":void 0}},padding:3*!x,rounding:4,children:x?(0,c.jsx)(U,{hideAddObjects:b,imageSignature:i,objectType:R,onAddItem:function(){},onCancelItem:u,onEditItem:d,onEnter:function(){},parentObjectId:C.id,statusType:"textInFlightNested",tags:D,text:a,widthAuto:!0}):(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)(et,{createdAt:z,isHighlighted:j,user:M}),E?(0,c.jsx)($.Z,{allowReveal:!0,size:"100",taggedUsers:T,tags:D,text:a}):(0,c.jsx)(J,{size:"100",taggedUsers:T,tags:D,text:a}),A&&W&&G&&(0,c.jsx)(eo.Z,{fallback:(0,c.jsx)(ei.Z,{accessibilityLabel:Z._('Loading comment reply Pin preview', 'Loading pin previews for comment reply comments component', 'Loading pin previews for comment reply comments component')}),children:(0,c.jsx)(l.xu,{marginTop:1,maxWidth:"21%",children:(0,c.jsx)(ea.rX,{pinKey:{type:"deprecated",data:G},slotIndex:I,surface:"CommentReply"})})})]})}),!L&&!W&&!x&&!w&&(0,c.jsx)(l.xu,{padding:1,children:(0,c.jsx)(el.Z,{commentCount:r,flyout:x?null:s,helpfulCount:_,hideReplyCount:v,isLikedByMe:P,isMarkedHelpfulByMe:O,onHelpfulClick:p,onLikeClick:h,onReplyClick:m,onReplyCountClick:y,reactionCounts:S,small:!0})})]})]})})}var eu=n(868977),ed=n(761254),ep=n(684556),ef=n(265332),eh=n(231333),em=n(586033),eg=n(987775),ey=n(121006),e_=n(339908),eb=n(921506),ev=n(365797),ex=n(29210),ej=n(932226),eP=n(226003),eO=n(903683),ew=n(906417);function eC(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function eS(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eA(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eA(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eI=function(e){var t,n,r=e.aggregatedCommentId,a=e.apdId,s=e.creatorId,u=e.depth,d=e.didItOwnerId,p=e.isManagedView,f=e.objectType,y=e.onUpdate,_=e.parentObjectId,b=e.pinDomainOwnerId,x=e.pinId,j=e.slotIndex,O=e.viewerId,w=e.showHighlightEducator,C=e.numHighlights,S=e.canSetHighlight,A=e.isORBACProfileManager,I=(0,v.v)().logContextEvent,T=(0,ev.Z)(),D=(0,g.ZP)(),E=(0,er.Z)({name:"PinResource",options:{id:x,field_set_key:"detailed"}}).isLoaded,k=(0,e_.F9)().showToast,z=(0,ew.f)().reportComment,M=(0,eb.lV)(),R=(0,eb.nf)(),L=R.aggregatedCommentsHiddenForUser,H=R.deleteCommentMention,B=R.toggleAggregatedCommentHelpful,F=R.toggleAggregatedCommentHighlight,N=R.toggleAggregatedCommentLike,V=R.updateAggregatedComment,Y=(0,eu.Z)(),K=(0,ed.Z)(),G=M[r],W=(0,ex.G)().nativeEngagementsHiddenForUser,q=eS((0,o.useState)(!1),2),X=q[0],J=q[1],$=eS((0,o.useState)(!1),2),Q=$[0],ee=$[1],et=eS((0,o.useState)(!1),2),en=et[0],eo=et[1],ei=eS((0,o.useState)(!1),2),ea=ei[0],el=ei[1],es=eS((0,o.useState)(!1),2),eA=es[0],eI=es[1],eT=eS((0,o.useState)(!1),2),eD=eT[0],eE=eT[1],ek=(0,i.I0)();(0,o.useEffect)(function(){ek((0,eg.U)("AggregatedCommentResource",{options:{commentId:r}}))},[ek,r]),(0,o.useEffect)(function(){y&&y()},[y]);var ez=(0,eO.S6)()(x),eM="pin";if(ez){var eR,eL=!!(null!=(eR=ez.videos)&&eR.video_list);ez.story_pin_data_id?eM="story":eL&&(eM="video")}if(!G||!G.user)return null;var eU=G.comment_response_pin,eH=G.comment_count,eZ=G.created_at,eF=G.helpful_count,eN=G.marked_helpful_by_me,eV=G.reaction_by_me,eK=G.reaction_counts,eG=G.tagged_users,eW=G.tags,eq=G.text,eX=G.user,eJ=eX.id,e$=eX.username,eQ=G.highlighted_by_pin_owner,e0=u===eB,e1=eK[1],e2=function(){N({aggregatedCommentId:r,isLikedByMe:!!eV})},e8=function(){B({aggregatedCommentId:r,isMarkedHelpfulByMe:!!eN})},e3=function(){if(C&&C>=3)return void k(function(e){var t=e.hideToast;return(0,c.jsx)(eh.Z,{onHide:t,text:D._('Only 3 comments can be highlighted', 'closeup.pinActionDropDown.commentHighlightMaxNumberToast', 'Toast that tells user that at most 3 comments can be highlighted.')})});F({aggregatedCommentId:r,pinId:x,isHighlighted:!1}),k(function(e){var t=e.hideToast;return(0,c.jsx)(eh.Z,{onHide:t,primaryAction:{accessibilityLabel:D._('Undo comment highlight or comment highlight removal', 'closeup.pinActionDropDown.commentHighlightToast.a11yUndoButton', 'Accessibility label for toast to undo comment highlight or comment highlight removal'),label:D._('Undo', 'closeup.pinActionDropDown.commentHighlightToast.UndoButton', 'Undo comment highlight or comment highlight removal'),size:"lg",onClick:function(){F({aggregatedCommentId:r,pinId:x,isHighlighted:!0})}},text:D._('Comment highlighted', 'closeup.pinActionDropDown.commentHighlightToast', 'Toast that tells user that they have successfully highlighted a comment.')})})},e5=function(){F({aggregatedCommentId:r,pinId:x,isHighlighted:!0}),k(function(e){var t=e.hideToast;return(0,c.jsx)(eh.Z,{onHide:t,primaryAction:{accessibilityLabel:D._('Undo comment highlight or comment highlight removal', 'closeup.pinActionDropDown.commentHighlightToast.a11yUndoButton', 'Accessibility label for toast to undo comment highlight or comment highlight removal'),label:D._('Undo', 'closeup.pinActionDropDown.commentHighlightToast.UndoButton', 'Undo comment highlight or comment highlight removal'),size:"lg",onClick:function(){F({aggregatedCommentId:r,pinId:x,isHighlighted:!1})}},text:D._('Highlight removed', 'closeup.pinActionDropDown.commentHighlightRemovalToast', 'Toast that tells user that they have successfully removed a comment highlight.')})})},e6=function(){eo(!en)},e4=(t=regeneratorRuntime.mark(function e(t){var n,o,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.contentMarkdown,o=t.tags,a=r,e6(),ee(!0),e0&&(a=_,i=r),e.next=7,ek(Y({objectType:P.o.aggregatedComment,objectId:a,tags:o,text:n,replyToCommentId:i}));case 7:ee(!1);case 8:case"end":return e.stop()}},e)}),n=function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){eC(i,r,o,a,l,"next",e)}function l(e){eC(i,r,o,a,l,"throw",e)}a(void 0)})},function(e){return n.apply(this,arguments)}),e7=function(){J(!0)},e9=function(){J(!1)},te=function(e){V({commentId:r,force:!0,tags:e.tags,text:e.contentMarkdown}),J(!1)},tt=function(){H(r),I({event_type:8909,component:13464,view_type:3,view_parameter:140,aux_data:{tag_id:O,tag_type:1}}),k(function(e){var t=e.hideToast;return(0,c.jsx)(eh.Z,{onHide:t,text:D._('@mention removed!', 'closeup.pinActionDropDown.mentionRemovalToast', 'Toast that tells user that they have successfully removed the @mention of them in another user\'s Pin description')})})},tn=function(){el(!0)},tr=function(){eE(!0)},to=function(){el(!1),eI(!1),eE(!1)},ti=function(){z(r,_,f===P.o.aggregatedComment?"aggregatedcomment":"userdiditdata")},ta=function(){var e=[eJ,s,d,b].includes(O),t=O===eJ,n=O!==eJ,r=O!==eJ,o=eG.filter(function(e){return e.id===O}).length>0;return(0,c.jsx)(Z.Z,{handleBlockUser:r?tr:null,handleClickReport:n?ti:null,handleDelete:e?tn:null,handleHighlight:S&&!eQ?e3:null,handleOnEdit:t?e7:null,handleRemoveHighlight:S&&eQ?e5:null,handleRemoveMention:o?tt:null,showHighlightEducator:w,small:!0})};return(0,c.jsxs)(o.Fragment,{children:[(0,c.jsx)(em.F,{componentType:f===P.o.pin?13696:13697,contextLogData:{objectId:G.id},impressionAuxFields:{commentId:G.id,pinId:x,pinType:eM,parentId:_,parentType:f,commentType:P.o.aggregatedComment},impressionType:"Comment",isPaused:!E,loggingId:G.id,slotIndex:j,viewType:3,children:function(e){var t=e.impressionTrackerRef;return(0,c.jsx)(l.xu,{ref:t,"data-test-id":"aggregatedCommentContainer-comment",children:(0,c.jsx)(ec,{avatarSize:e0?"sm":"md",commentAuthor:G.user,commentCount:eH,commentId:r,contentText:eq,createdAt:eZ,flyout:ta(),handleHelpfulClick:e8,handleLikeClick:e2,handleOnEditCancel:e9,handleOnEdited:te,handleReplyClick:e6,helpfulCount:eF,hideAddObjects:!0,hideReplyCount:!0,inEditMode:X,isHighlighted:eQ,isLikedByMe:!!eV,isMarkedHelpfulByMe:eN,isORBACProfileManager:A,parentObject:{id:_},reactionCounts:eK,responsePinId:null==eU?void 0:eU.id,slotIndex:j,taggedUsers:eG,tags:eW,truncateText:!0,type:P.o.aggregatedComment})})}}),en&&(0,c.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{paddingLeft:48*!e0}},"data-test-id":"aggregatedCommentContainer-replyComposer",children:(0,c.jsx)(l.xu,{display:"flex",marginTop:2,children:(0,c.jsx)(l.xu,{flex:"grow",children:(0,c.jsx)(U,{avatarSize:"sm",hideAddObjects:!0,objectType:P.o.aggregatedComment,onAddItem:e4,onCancelItem:e6,onEnter:function(){},parentObjectId:_,replyToObject:e0?G:null,statusType:"textInflightCreation"})})})}),eH>0&&(0,c.jsxs)(l.xu,{dangerouslySetInlineStyle:{__style:{paddingLeft:48}},"data-test-id":"aggregatedCommentContainer-replyList",children:[(0,c.jsx)(eY,{baseIndex:j+1,commentCount:eH,creatorId:s,depth:u,didItOwnerId:d,isManagedView:p,isORBACProfileManager:A,objectId:r,objectType:P.o.aggregatedComment,onUpdate:y,parentObjectId:_,pinDomainOwnerId:b,pinKey:null!=ez?{type:"deprecated",data:ez}:null,variant:"legacy"}),(0,c.jsx)(l.xH,{accessibilityLabel:D._('Comments loading', ' - ', ' -- '),show:Q})]}),ea&&(0,c.jsx)(m,{accessibilityModalLabel:D._('Deleting a comment', 'closeup.deleteCommentModal.label', 'Label for deleting a comment'),cancelButtonText:D._('Cancel', 'closeup.deleteCommentModal.cancelButton', 'Cancel deleting comment'),confirmButtonText:D._('Delete', 'closeup.deleteCommentModal.confirmButton', 'Delete comment'),detail:D._('This comment will be deleted', 'closeup.deleteCommentModal.detailText', 'confirmation before deleting comment'),heading:D._('Are you sure?', 'closeup.deleteCommentModal.heading', 'Are you sure to remove post or comment'),onConfirm:function(){ek(K({aggregatedCommentId:r,aggregatedPinId:a,feedType:"aggregatedComments",type:e0?ef.Rv.REPLY_TO_AGGREGATED:ef.Rv.TOP,parentId:_,updateParentCommentCount:!0,pinId:x}))},onDismiss:to}),eA&&(0,c.jsx)(h.ZP,{accessibilityModalLabel:D._('Users who have liked this.', 'closeup.comment.showLikeListModal.label', 'Label for a modal showing a list of users who have liked a Tried Item Comment'),heading:(0,ey.Z)(D.ngettext('{{count}} Like', '{{count}} Likes', e1, 'closeup.comment.showLikeListModal.heading', 'Number of likes a comment has'),{count:e1.toString()}),onDismiss:to,size:"md",children:(0,c.jsx)(ep.Xd,{id:r})}),eD&&(0,c.jsx)(ej.default,{firstName:e$,onBlockUser:function(){ek((0,eP.Ge)({id:eJ,blockSource:"comment",blockContext:r,logContextEvent:I})),L(eJ),W(eJ),to(),T()},onClearModal:to})]})},eT=n(962119),eD=n(51340),eE=n(857147),ek=n(755090),ez=n(875202);function eM(e){return(eM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eR(Object(n),!0).forEach(function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!=eM(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eM(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eM(t)?t:t+""}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eU(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function eH(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return eZ(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eZ(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eZ(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eB=2,eF=void 0!==r?r:r=n(637129),eN=function(e){var t,n,r,i,a=e.baseIndex,s=void 0===a?0:a,u=e.commentCount,d=e.creatorId,f=e.depth,h=void 0===f?0:f,m=e.didItOwnerId,y=e.feedItems,_=e.feedResourceName,b=e.initialLoadCount,x=e.isManagedView,O=e.objectId,w=e.objectType,C=e.onUpdate,S=e.parentObjectId,A=e.pinDomainOwnerId,I=e.pinKey,T=e.privatePin,D=e.shouldFeatureComment,E=void 0!==D&&D,k=e.variant,z=e.isORBACProfileManager,M=(0,v.v)().logContextEvent,R=(0,g.ZP)(),L=eH((0,o.useState)(!1),2),Z=L[0],B=L[1],F=eH((0,o.useState)(!1),2),N=F[0],V=F[1],Y=(0,j.Z)(),K=(0,en.K)(),G=(0,p.TH)(),W=(0,eE.mB)(G.search).comment_is_hidden,q=1===parseInt(void 0===W?"0":W,10),X=(0,e_.F9)().showOneToast,J=(0,eu.Z)(),$=(0,eT.Z)(eF,I);(0,ek.Z)(function(){if(K&&q&&E){var e=R._('Sorry, the comment has been hidden', 'AggregatedCommentList.featuredComment.isHidden', 'Error message for featured comment is unavailable');X(function(t){var n=t.hideToast;return(0,c.jsx)(eh.Z,{onHide:n,text:e})})}});var Q=(0,er.Z)({name:_,options:{objectId:O,page_size:b||2,redux_normalize_feed:!0,featured_ids:E&&K&&!q?[K]:null}}),ee=Q.fetchMore,et=Q.isAtEnd,eo=Q.isLoaded,ei=null==$?void 0:$.entityId,ea=$&&$.pinner?$.pinner.entityId:"",el=!!$&&$.storyPinDataId,es=null!=(r=null==$||null==(i=$.aggregatedPinData)?void 0:i.entityId)?r:"";(0,o.useEffect)(function(){eo&&C&&C()},[eo,C]);var ec=function(){B(!Z)},ed=(t=regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.contentMarkdown,r=t.tags,ec(),V(!0);try{J({objectType:w,objectId:O,pinId:ei,tags:r,text:n}),w===P.o.pin&&M({event_type:7,object_id_str:ei,aux_data:eL({num_user_mention_tags:(r?JSON.parse(r):[]).length},el?{creator_id:d,story_pin_data_id:el}:{})})}catch(e){}V(!1);case 5:case"end":return e.stop()}},e)}),n=function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(e){eU(i,r,o,a,l,"next",e)}function l(e){eU(i,r,o,a,l,"throw",e)}a(void 0)})},function(e){return n.apply(this,arguments)}),ep=!!y&&eo&&u>y.length&&!et,ef=y?u-y.length:0,em=(0,eD.nk)(R.ngettext('{{commentCount}} comment', '{{commentCount}} comments', ef, 'Show comments link with count', 'Show comments link with count'),{commentCount:String(ef)}).join(""),eg=w===P.o.aggregatedComment,ey=w===P.o.pin&&(y&&0===y.length||0===u)&&eo&&!N,eb="default"===k,ev=0===h,ex=ev&&$&&$.highlightedAggregatedComments?$.highlightedAggregatedComments:[],ej=ev&&Y.isAuth&&Y.id===ea,eP=ej;return(0,c.jsxs)(l.xu,{"data-test-id":"aggregated-comment-list",marginTop:eg&&!eb?2:0,paddingY:eg||eb?0:2,children:[!!ei&&ex.map(function(e,t){return(0,c.jsx)(l.xu,{marginBottom:2,children:(0,c.jsx)(eI,{aggregatedCommentId:e,apdId:es,canSetHighlight:ej,creatorId:d,depth:h+1,didItOwnerId:m,isManagedView:x,isORBACProfileManager:z,objectType:w,onUpdate:C,parentObjectId:w===P.o.pin?ei:O,pinDomainOwnerId:A,pinId:ei,slotIndex:s+t,viewerId:Y.isAuth?Y.id:""})},e)}),!!ei&&(null==y?void 0:y.filter(function(e){return!ex.includes(e.id)}).map(function(e,t){var n=e.id,r=eP;return eP=!1,(0,c.jsx)(l.xu,{marginBottom:2,children:(0,c.jsx)(eI,{aggregatedCommentId:n,apdId:es,canSetHighlight:ej,creatorId:d,depth:h+1,didItOwnerId:m,isManagedView:x,isORBACProfileManager:z,numHighlights:ex.length,objectType:w,onUpdate:C,parentObjectId:w===P.o.pin?ei:O,pinDomainOwnerId:A,pinId:ei,showHighlightEducator:r,slotIndex:s+ex.length+t,viewerId:Y.isAuth?Y.id:""})},n)})),(0,c.jsx)(l.xH,{accessibilityLabel:R._('Comments loading', ' - ', ' -- '),show:!eo||N}),ep&&(0,c.jsx)(l.xu,{marginTop:3,children:(0,c.jsx)(H.Z,{handleClick:ee,text:em})}),ey&&(0,c.jsx)(l.xu,{paddingY:2*!eb,children:(0,c.jsx)(l.xv,{size:eb?"100":"200",children:R._('Share feedback, ask a question or give a high five', ' - ', ' -- ')})}),!z&&w!==P.o.aggregatedComment&&!x&&(0,c.jsx)(l.xu,{display:"flex",marginTop:6,children:(0,c.jsx)(l.xu,{"data-test-id":"add-comment",flex:"grow",children:(0,c.jsx)(U,{hideAddObjects:!0,objectType:w,onAddItem:ed,onCancelItem:ec,onEnter:ec,parentObjectId:S||"",privatePin:T,replyToObject:null,statusType:Z?"textInflightCreation":"textStaticDisplay"})})})]})},eV=function(e){return(0,i.v9)(function(t){return t.feeds["".concat(ez.Z.AGGREGATED_COMMENTS,":").concat(e)]})},eY=function(e){var t;return(0,c.jsx)(eN,eL(eL({},e),{},{feedItems:null!=(t=eV(e.objectId))?t:[],feedResourceName:"AggregatedCommentReplyFeedResource"}))},eK=function(e){var t;return(0,c.jsx)(eN,eL(eL({},e),{},{feedItems:null!=(t=eV(e.objectId))?t:[],feedResourceName:"DidItCommentsResource"}))};function eG(e){var t=e.item.images,n=e.item.pin&&e.item.pin.title||"",r=t.length>0,o=t[0]?t[0]["750x"]:null;if(!r||!o)return null;var i=o.url;return(0,c.jsx)(l.zd,{rounding:2,wash:!0,children:(0,c.jsx)(l.Ee,{alt:n,color:"#efefef",naturalHeight:o.height,naturalWidth:o.width,src:i},i)})}var eW=n(711111),eq=n(71408);function eX(e){return(eX="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eJ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function e$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eJ(Object(n),!0).forEach(function(t){var r,o,i;r=e,o=t,i=n[t],(o=function(e){var t=function(e,t){if("object"!=eX(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=eX(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==eX(t)?t:t+""}(o))in r?Object.defineProperty(r,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[o]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eJ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function eQ(e){var t=(0,g.ZP)();return(0,c.jsx)(eq.Z,e$(e$({thriftComponentType:193},e),{},{children:function(e){var n=e.onTriedItButtonClick;return(0,c.jsx)(l.iP,{onTap:function(e){return n(e.event)},children:(0,c.jsx)(l.xu,{paddingX:2,paddingY:1,children:(0,c.jsx)(l.xv,{weight:"bold",children:t._('Save', 'comment save button', 'comment save button')})})})}}))}var e0=n(87134),e1=n(509228),e2=n(135376),e8=n(397657),e3=n(617100),e5=n(640018),e6=n(238872);function e4(e){return(e4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e7(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function e9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e7(Object(n),!0).forEach(function(t){to(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e7(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function te(e,t){return(te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function tt(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(tn=function(){return!!e})()}function tr(e){return(tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function to(e,t,n){return(t=ti(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ti(e){var t=function(e,t){if("object"!=e4(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=e4(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==e4(t)?t:t+""}var ta=function(e){var t=e.isLikedByMe,n=e.onClick,r=(0,g.ZP)(),o=(0,e2.Z)();return(0,c.jsx)(l.hU,{accessibilityLabel:r._('Like', ' - ', ' -- '),icon:"heart",iconColor:t?"red":"gray",onClick:function(){o?o():n()},size:"md"})},tl=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&te(o,e);var t,n,r=(t=tn(),function(){var e,n=tr(o);return e=t?Reflect.construct(n,arguments,tr(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==e4(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return tt(e)}(this,e)});function o(){if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var e,t,n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];return to(tt(t=r.call.apply(r,[this].concat(i))),"state",{isLikedByMe:null!=(e=t.props.item.liked_by_me)&&e,likeCount:t.props.item.like_count,showDeleteModal:!1,showEditModal:!1,showFlyout:!1,showLikesListModal:!1,showShareFlyout:!1,isDeleteHover:!1,isReportHover:!1}),to(tt(t),"handleClickthrough",function(){var e=t.props,n=e.handlePinClickLogging,r=e.logContextEvent,o=e.item.id;n&&n(),r({event_type:101,component:172,element:1263,object_id_str:o})}),to(tt(t),"handleClickHashTag",function(){var e=t.props;(0,e.logContextEvent)({event_type:101,component:172,element:10194,object_id_str:e.item.id})}),to(tt(t),"handleToggleLikesListModal",function(){return t.setState(function(e){return{showLikesListModal:!e.showLikesListModal}})}),to(tt(t),"handleClickLike",function(){var e=t.props,n=e.item.id,r=e.viewType,o=e.logContextEvent,i=t.state,a=i.isLikedByMe,l=i.likeCount;o({event_type:101,component:172,element:1353,object_id_str:n,view_type:r}),t.setState({isLikedByMe:!a,likeCount:a?l-1:l+1}),(0,e8.Z)({url:"/v3/did_it/".concat(n,"/like/"),method:a?"DELETE":"POST"})}),to(tt(t),"handleToggleFlyout",function(){return t.setState(function(e){return{showFlyout:!e.showFlyout,showShareFlyout:!1}})}),to(tt(t),"handleShowShareFlyout",function(){return t.setState({showShareFlyout:!0})}),to(tt(t),"handleDismissFlyout",function(){t.state.showEditModal||t.setState({showFlyout:!1,showShareFlyout:!1})}),to(tt(t),"handleShowReportModal",function(){var e,n=t.props,r=n.item,o=r.id,i=r.pin.aggregated_pin_data,a=n.removeReportedActivity;(0,n.reportComment)(o,null!=(e=null==i?void 0:i.id)?e:"","userdiditdata"),a&&a(o)}),to(tt(t),"handleShowDeleteModal",function(){return t.setState({showDeleteModal:!0})}),to(tt(t),"handleDeleteConfirmation",function(e){var n=t.props,r=n.item,o=r.id,i=r.pin,a=i.aggregated_pin_data,l=void 0===a?{}:a,s=i.id,c=r.user,u=n.deleteUserDidItData,d=n.logContextEvent;if(t.setState({showDeleteModal:!1}),e&&c){var p=c.username;d({event_type:101,view_type:101,component:192,element:1264,object_id_str:s}),u({aggregatedPinDataId:null==l?void 0:l.id,id:o,isOwnedByMe:t.isOwnedByCurrentUser,pinId:s,username:p})}}),to(tt(t),"handleToggleEditModal",function(e){return t.setState({showEditModal:e,showFlyout:e})}),to(tt(t),"handleClickHelpful",function(){var e=t.props,n=e.didItDataId,r=e.item.marked_helpful_by_me;(0,e.toggleHelpful)({didItDataId:n,isMarkedHelpfulByMe:!!r})}),to(tt(t),"handleDeleteMouseEnter",function(){return t.setState({isDeleteHover:!0})}),to(tt(t),"handleDeleteMouseLeave",function(){return t.setState({isDeleteHover:!1})}),to(tt(t),"handleReportMouseEnter",function(){return t.setState({isReportHover:!0})}),to(tt(t),"handleReportMouseLeave",function(){return t.setState({isReportHover:!1})}),to(tt(t),"renderFlyout",function(){var e,n,r,o=t.props,i=o.creatorId,a=o.item,s=a.details,u=a.id,d=a.images,p=a.pin,f=a.privacy,h=a.user,m=o.viewer,g=p||{},y=g.aggregated_pin_data,_=void 0===y?{}:y,b=g.id,v=g.images,x=g.link_domain,j=g.rich_metadata,P=g.title,O=t.state,w=O.showFlyout,C=O.showShareFlyout,S=((void 0===x?{}:x)||{}).official_user||{},A=((void 0===j?{}:j)||{}).title,I={description:s,id:u,imageUrl:d.length>0?null==d||null==(e=d[0])||null==(n=e["550x"])?void 0:n.url:null==(r=(void 0===v?{}:v)["136x136"])?void 0:r.url,name:A||t.props.i18n._('this idea', ' - ', ' -- '),type:e6.d.DID_IT,url:"/pin/".concat(b,"/activity/tried/").concat(u)},T=t.isOwnedByCurrentUser||m.isAuth&&m.id===S.id||m.isAuth&&m.id===i;return(0,c.jsxs)(l.xu,{children:[(0,c.jsx)(l.xu,{ref:function(e){t.flyoutAnchor=e},children:(0,c.jsx)(l.hU,{accessibilityExpanded:w,accessibilityHaspopup:!0,accessibilityLabel:t.props.i18n._('more options', 'accessible label for button to see more options on report content', 'accessible label for button to see more options on report content'),icon:"ellipsis",iconColor:"gray",onClick:t.handleToggleFlyout,size:"sm"})}),w&&(0,c.jsx)(l.mh,{children:(0,c.jsx)(l.xu,{alignSelf:"end",children:(0,c.jsx)(l.J2,{anchor:t.flyoutAnchor,idealDirection:"down",onDismiss:t.handleDismissFlyout,size:C?"lg":"xs",children:C?(0,c.jsx)(e5.Z,{component:56,onHide:t.handleToggleFlyout,sendType:"did_it",sharedObject:I,viewType:3}):(0,c.jsx)(l.xu,{alignSelf:"start",color:"default",column:12,display:"flex",position:"relative",rounding:2,children:(0,c.jsxs)(l.sg,{span:12,children:["public"===f&&(0,c.jsx)(l.xu,{children:(0,c.jsx)(l.iP,{onTap:t.handleShowShareFlyout,children:(0,c.jsx)(l.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(l.xv,{weight:"bold",children:t.props.i18n._('Share', ' - ', ' -- ')})})})}),(0,c.jsx)(l.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(l.rU,{href:t.pinURL,onClick:t.handleClickthrough,children:(0,c.jsx)(l.xv,{weight:"bold",children:t.props.i18n._('Go to Pin', ' - ', ' -- ')})},t.pinURL)}),h&&(t.isOwnedByCurrentUser||T)?(0,c.jsxs)(l.xu,{children:[t.isOwnedByCurrentUser&&(0,c.jsx)(l.kC,{alignItems:"stretch",justifyContent:"start",children:(0,c.jsx)(eQ,{aggregatedPinDataId:null==_?void 0:_.id,isDoneByMe:t.isOwnedByCurrentUser,loggedInUser:h,onToggleModal:t.handleToggleEditModal,pinId:b,pinTitle:P,userDidItDataId:u})}),T&&(0,c.jsx)(l.iP,{onTap:t.handleShowDeleteModal,children:(0,c.jsx)(l.xu,{"data-test-id":"flyout-delete-button",display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(l.xv,{weight:"bold",children:t.props.i18n._('Delete', ' - ', ' -- ')})})})]}):(0,c.jsx)(l.iP,{onTap:t.handleShowReportModal,children:(0,c.jsx)(l.xu,{display:"flex",paddingX:2,paddingY:1,children:(0,c.jsx)(l.xv,{weight:"bold",children:t.props.i18n._('Report this content', ' - ', ' -- ')})})})]})})})})})]})}),to(tt(t),"renderStatsBar",function(){var e=t.props,n=e.item,r=n.comment_count,o=n.done_at,i=n.marked_helpful_by_me,a=n.helpful_count,s=e.isManagedView,u=e.viewer,d=t.props.item.pin&&t.props.item.pin.link_domain||{},p=t.state,f=p.isLikedByMe,h=p.likeCount,m=p.isDeleteHover,g=p.isReportHover,y=(0,ey.Z)(t.props.i18n.ngettext('{{likeCount}} like', '{{likeCount}} likes', h, ' - ', ' -- '),{likeCount:h}),_=(0,ey.Z)(t.props.i18n.ngettext('{{commentCount}} comment', '{{commentCount}} comments', r, ' - ', ' -- '),{commentCount:r}),b=d.official_user||{},v=t.isOwnedByCurrentUser||u.isAuth&&u.id===b.id,x=t.props.getHumanizedTimeSince(o,!0);return(0,c.jsxs)(l.xu,{alignItems:"center",column:12,display:"flex",children:[(0,c.jsxs)(l.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,c.jsx)(l.xv,{size:"200",children:s?x:(0,c.jsx)(e1.Z,{dateFormatType:e1.k.LONG,useUTC:!1,value:new Date(o)})}),r>0&&(0,c.jsx)(l.xu,{marginStart:6,children:(0,c.jsx)(l.xv,{size:"200",weight:"bold",children:_})}),h>0&&(0,c.jsx)(l.xu,{"data-test-id":"did_it_show_likes_tap_area",marginStart:6,children:(0,c.jsx)(l.iP,{onTap:t.handleToggleLikesListModal,children:(0,c.jsx)(l.xv,{size:"200",weight:"bold",children:y})})})]}),(0,c.jsxs)(l.kC,{alignItems:"stretch",flex:"grow",justifyContent:"end",children:[(0,c.jsx)(l.xu,{display:"flex",justifyContent:h>0?"between":"end",marginBottom:1,marginTop:1,children:u.isAuth&&(0,c.jsx)(ta,{isLikedByMe:f,onClick:t.handleClickLike})}),(0,c.jsx)(l.xu,{display:"flex",paddingY:3,children:(0,c.jsx)(el.N,{helpfulCount:a,isMarkedHelpfulByMe:i,onHelpfulClick:t.handleClickHelpful})})]}),s&&(0,c.jsx)(l.kC,{alignItems:"stretch",flex:"none",children:(0,c.jsx)(l.iP,{onMouseEnter:t.handleReportMouseEnter,onMouseLeave:t.handleReportMouseLeave,onTap:t.handleShowReportModal,rounding:"pill",children:(0,c.jsx)(l.xu,{padding:2,children:(0,c.jsx)(l.xv,{color:g?"default":"subtle",size:"200",weight:"bold",children:t.props.i18n._('Report', ' - ', ' -- ')})})})}),s&&v&&(0,c.jsx)(l.kC,{alignItems:"stretch",flex:"none",children:(0,c.jsx)(l.iP,{onMouseEnter:t.handleDeleteMouseEnter,onMouseLeave:t.handleDeleteMouseLeave,onTap:t.handleShowDeleteModal,rounding:"pill",children:(0,c.jsx)(l.xu,{padding:2,children:(0,c.jsx)(l.xv,{color:m?"default":"subtle",size:"200",weight:"bold",children:t.props.i18n._('Delete', ' - ', ' -- ')})})})})]})}),to(tt(t),"renderPinInfoBar",function(){var e,n,r=t.props,o=r.item,i=o.images,a=o.pin,s=o.user,u=r.isManagedView,d=(s||{}).full_name,p=a.dominant_color,f=a.images,h=void 0===f?{}:f,m=a.rich_metadata,g=a.title,y=((void 0===m?{}:m)||{}).title;return n=t.isOwnedByCurrentUser&&y?(0,eD.nk)(t.props.i18n._('You tried {{pinTitleForTriedByText}}', 'Navigating to a Pin from a try', 'Navigating to a Pin from a try'),{pinTitleForTriedByText:y}):y?(0,eD.nk)(t.props.i18n._('{{fullName}} tried {{pinTitleForTriedByText}}', 'Navigating to a Pin from a try', 'Navigating to a Pin from a try'),{fullName:d,pinTitleForTriedByText:y}):t.isOwnedByCurrentUser?t.props.i18n._('See the Pin you tried', 'Navigating to a Pin from a try', 'Navigating to a Pin from a try'):t.props.i18n._('See the Pin that inspired it', 'call to action - navigating to a Pin from a try', 'call to action - navigating to a Pin from a try'),(0,c.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:i.length?{backgroundImage:"linear-gradient(to bottom, rgba(118, 118, 118, 0), rgba(0, 0, 0, 0.2) 33%, rgba(0, 0, 0, 0.5) 66%, rgba(0, 0, 0, 0.7))"}:{}},rounding:2*!!i.length,children:(0,c.jsx)(l.Tg,{href:t.pinURL,onTap:t.handleClickthrough,children:(0,c.jsxs)(l.xu,{alignItems:"center",display:"flex",paddingX:3*!!i.length,paddingY:3,children:[(0,c.jsxs)(l.xu,{alignItems:"center",display:"flex",flex:"grow",justifyContent:"start",marginEnd:2,children:[(0,c.jsx)(l.xu,{marginEnd:3,width:60,children:(0,c.jsx)(l.zd,{rounding:2,wash:!0,children:(null==(e=h["136x136"])?void 0:e.url)&&(0,c.jsx)(l.Ee,{alt:null!=g?g:"",color:null!=p?p:"transparent",naturalHeight:60,naturalWidth:60,src:h["136x136"].url})})}),(0,c.jsxs)(l.xv,{color:i.length?"inverse":"default",size:u?"100":"300",weight:"bold",children:[" ",n," "]})]}),(0,c.jsx)(l.JO,{accessibilityLabel:t.props.i18n._('See pin', ' - ', ' -- '),color:i.length?"inverse":"default",icon:"arrow-forward",size:32})]})},t.pinURL)})}),t}return n=[{key:"isOwnedByCurrentUser",get:function(){var e=this.props,t=e.viewer,n=e.item;return!!(t.isAuth&&n.user&&t.id===n.user.id)}},{key:"pinURL",get:function(){return"/pin/".concat(this.props.item.pin.id,"/")}},{key:"render",value:function(){var e,t,n,r=this.props,o=r.creatorId,i=r.isManagedView,a=r.item,s=r.viewType,u=this.state,p=u.likeCount,f=u.showDeleteModal,m=u.showLikesListModal,g=a.comment_count,y=a.details,_=a.id,b=a.images,v=a.pin,x=a.user,j=a.videos,O=x||{},w=O.full_name,C=O.id,S=O.image_medium_url,A=O.username,I="/".concat(A,"/");(0,ey.Z)(this.props.i18n.ngettext('{{likeCount}} like', '{{likeCount}} likes', p, ' - ', ' -- '),{likeCount:p}),(0,ey.Z)(this.props.i18n.ngettext('{{commentCount}} comment', '{{commentCount}} comments', g, ' - ', ' -- '),{commentCount:g});var T=!!(null!=j&&null!=(e=j[0])&&null!=(t=e.video_list)&&t.V_HLSV4),D=!!(null!=(n=b[0])&&n["750x"]),E=D||T,k=82!==s,z=D&&k;return(0,c.jsxs)(l.xu,{alignItems:"stretch",direction:"column",display:"flex",justifyContent:"between",paddingY:7,children:[(0,c.jsxs)(l.xu,{alignItems:"center",column:12,display:"flex",children:[(0,c.jsx)(l.kC,{alignItems:"center",children:(0,c.jsx)(l.xu,{marginEnd:3,width:i?36:42,children:(0,c.jsx)(l.Tg,{href:I,onTap:this.handleClickthrough,rounding:"circle",children:(0,c.jsx)(l.zd,{rounding:"circle",wash:!0,children:S&&(0,c.jsx)(l.Ee,{alt:null!=A?A:"",color:"#efefef",naturalHeight:42,naturalWidth:42,src:S},S)})},I)})}),(0,c.jsx)(l.xu,{column:1,display:"flex",mdDisplay:"none"}),(0,c.jsxs)(l.xu,{alignItems:"center",column:12,display:"flex",justifyContent:"between",children:[(0,c.jsx)(l.xv,{size:i?"200":"300",children:(0,c.jsx)(l.rU,{href:I,onClick:this.handleClickthrough,children:w||""},I)}),!i&&this.renderFlyout()]})]}),(0,c.jsx)(l.xu,{marginBottom:+!i,marginTop:2,children:E&&(0,c.jsxs)(l.xu,{column:12,position:"relative",children:[T?(0,c.jsx)(eW.Z,{item:a,viewType:s}):(0,c.jsx)(eG,{item:a}),z&&(0,c.jsx)(l.xu,{bottom:!0,column:12,position:"absolute",children:this.renderPinInfoBar()})]})}),(0,c.jsxs)(l.xu,{marginStart:1,children:[D&&this.renderStatsBar(),y&&(0,c.jsx)(l.xu,{column:10,dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-line"}},marginBottom:2,children:(0,c.jsx)(l.xv,{size:i?"100":"300",children:(0,c.jsx)(d,{html:y,onClick:this.handleClickHashTag})})}),!D&&(0,c.jsxs)(l.xu,{children:[k&&this.renderPinInfoBar(),this.renderStatsBar()]}),(0,c.jsx)(l.xu,{column:12,children:(0,c.jsx)(eK,{commentCount:g,creatorId:o,didItOwnerId:C,objectId:_,objectType:P.o.didIt,pinKey:{type:"deprecated",data:v},variant:"legacy"})})]}),f&&(0,c.jsx)(e0.Z,{didItData:{id:_},onDeleteConfirmation:this.handleDeleteConfirmation}),m&&(0,c.jsx)(h.ZP,{accessibilityModalLabel:this.props.i18n._('Users who have liked this.', 'Label for a modal showing a list of users who have liked a Tried Item', 'Label for a modal showing a list of users who have liked a Tried Item'),allowScroll:!0,heading:(0,ey.Z)(this.props.i18n.ngettext('{{count}} Like', '{{count}} Likes', p, ' - ', ' -- '),{count:p.toString()}),onDismiss:this.handleToggleLikesListModal,size:"md",children:(0,c.jsx)(ep.Jo,{id:_})})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ti(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(o.PureComponent);function ts(e){var t=(0,v.v)().logContextEvent,n=(0,g.ZP)(),r=(0,ee.Z)(),o=(0,i.I0)(),l=(0,ew.f)().reportComment,s=(0,j.Z)(),u={deleteUserDidItData:(0,a.bindActionCreators)(e3.lg,o),toggleHelpful:(0,a.bindActionCreators)(e3.YH,o),updateUserDidItDataCommentCount:(0,a.bindActionCreators)(e3.L8,o)},d=(0,i.v9)(function(t){return t.didItData[e.didItDataId]}),p=d&&"comment_count"in d?d:void 0;return p&&(0,c.jsx)(tl,e9(e9(e9({},e),u),{},{getHumanizedTimeSince:r,i18n:n,item:p,logContextEvent:t,reportComment:l,viewer:s}))}},509228:function(e,t,n){n.d(t,{k:function(){return r.kH}});var r=n(906667),o=n(174646),i=n(19035);t.Z=function(e){var t=e.dateFormatType,n=e.useUTC,a=void 0===n||n,l=e.value;return(0,i.jsx)(o.LC,{children:function(e){return(0,r.ZP)(e.locale,l,t,a)}})}},906667:function(e,t,n){n.d(t,{A5:function(){return i},ZP:function(){return a},kH:function(){return r}});var r={LONG:"long",YEAR:"year",WEEKDAY_DATE:"weekday_date",WEEKDAY_DATE_TIME_TIMEZONE:"weekday_date_time_timezone",SHORT_WEEKDAY_DATE:"short_weekday_date",LONG_MONTH_YEAR:"long_month_year",NUMERIC:"numeric",MONTH_DAY:"month_day",SHORT_MONTH:"short_month",SHORT_MONTH_DAY:"short_month_day",DAY:"day",YEAR_SHORT_MONTH_DAY:"year_short_month_day",YEAR_SHORT_MONTH_DAY_HOUR:"year_short_month_day_hour",YEAR_SHORT_MONTH_DAY_TIME_TIMEZONE:"year_short_month_day_time_timezone",TIME:"time",TIME_TIMEZONE:"time_timezone",HOUR:"hour",TWO_DIGIT:"two_digit",TWO_DIGIT_YEAR:"two_digit_year"},o=function(e){switch(e){case r.YEAR:return{year:"numeric"};case r.LONG:return{year:"numeric",month:"long",day:"numeric"};case r.NUMERIC:return{year:"numeric",month:"numeric",day:"numeric"};case r.TWO_DIGIT:return{year:"numeric",month:"2-digit",day:"2-digit"};case r.TWO_DIGIT_YEAR:return{year:"2-digit",month:"2-digit",day:"2-digit"};case r.WEEKDAY_DATE:return{weekday:"long",month:"long",day:"numeric",year:"numeric"};case r.SHORT_WEEKDAY_DATE:return{weekday:"short",month:"numeric",day:"numeric"};case r.WEEKDAY_DATE_TIME_TIMEZONE:return{weekday:"short",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"};case r.MONTH_DAY:return{month:"long",day:"numeric"};case r.SHORT_MONTH:return{month:"short"};case r.SHORT_MONTH_DAY:return{month:"short",day:"numeric"};case r.DAY:return{day:"numeric"};case r.LONG_MONTH_YEAR:return{month:"long",year:"numeric"};case r.YEAR_SHORT_MONTH_DAY:return{year:"numeric",month:"short",day:"numeric"};case r.YEAR_SHORT_MONTH_DAY_HOUR:return{month:"short",year:"numeric",day:"numeric",hour:"numeric"};case r.YEAR_SHORT_MONTH_DAY_TIME_TIMEZONE:return{month:"short",year:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"};case r.TIME:return{hour:"numeric",minute:"2-digit"};case r.TIME_TIMEZONE:return{hour:"numeric",minute:"2-digit",timeZoneName:"short"};case r.HOUR:return{hour:"numeric"};default:throw Error('invalid dateFormatType "'+e+'"')}};function i(){return -1!==Intl.DateTimeFormat.toString().indexOf("[native code]")}function a(e,t,n){var r=!(arguments.length>3)||void 0===arguments[3]||arguments[3],a=o(n);return r&&(a.timeZone="UTC"),i()||(a.calendar="gregory"),new Intl.DateTimeFormat(e,a).format(t)}},81772:function(e,t,n){var r=n(267708),o=n(216029);t.Z=(0,r.Z5)(o.ZP)},267486:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){var t=!1;return{promise:new Promise(function(n,r){e.then(function(e){return t?r({isCanceled:!0}):n(e)},function(e){return t?r({isCanceled:!0}):r(e)})}),cancel:function(){t=!0}}}},522539:function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach(function(t){var r,i,a;r=e,i=t,a=o[t],(i=function(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}(i))in r?Object.defineProperty(r,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[i]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}t.Z=function(e){if(!e)return null;var t=e.pin.rich_metadata;return t?o(o({},e),{},{richMetadata:t}):null}},761732:function(e,t,n){n.d(t,{$4:function(){return T},A7:function(){return M},AQ:function(){return K},Bj:function(){return _},DB:function(){return G},FM:function(){return Q},G9:function(){return L},GX:function(){return g},Hy:function(){return eu},JO:function(){return E},Ke:function(){return D},LM:function(){return o},Lc:function(){return ep},Lr:function(){return ec},MN:function(){return v},Mn:function(){return ee},N8:function(){return y},NB:function(){return en},P0:function(){return er},P9:function(){return el},Pn:function(){return x},S:function(){return k},TK:function(){return P},TZ:function(){return S},UU:function(){return d},Uw:function(){return J},W_:function(){return es},XB:function(){return s},Xy:function(){return A},YM:function(){return O},aD:function(){return ef},aj:function(){return F},bA:function(){return R},bo:function(){return c},cH:function(){return ey},dS:function(){return C},eZ:function(){return h},fk:function(){return ei},g1:function(){return ed},gU:function(){return u},hH:function(){return Z},i2:function(){return p},iR:function(){return U},jh:function(){return eh},km:function(){return f},lx:function(){return z},mr:function(){return W},mt:function(){return Y},n_:function(){return B},np:function(){return V},of:function(){return r},q:function(){return eg},qY:function(){return w},qm:function(){return ea},rc:function(){return $},ro:function(){return em},sD:function(){return a},sG:function(){return m},u1:function(){return X},uR:function(){return l},v5:function(){return i},v9:function(){return q},vk:function(){return et},wj:function(){return j},x1:function(){return H},yC:function(){return b},yI:function(){return I},yb:function(){return N},zr:function(){return eo}});var r=880,o=340,i=380,a=510,l=40,s=20,c=4,u=474,d=134,p=96,f=800,h=186,m=40,g=10,y=48,_=88,b=183,v=130,x=24,j=400,P=50,O=8,w=8,C=5,S=29,A=5,I=20,T=400,D=100,E=800,k=800,z=500,M=3e3,R=40,L=100,U=5,H=["attempted","publishing","succeeded","uploading"],Z={carousel:[{w:2,h:3},{w:3,h:4},{w:1,h:1}],single:[{w:2,h:3},{w:3,h:4},{w:1,h:1}],story:[{w:9,h:16}],storyFARPortrait:[{w:1,h:2},{w:9,h:16},{w:2,h:3},{w:3,h:4},{w:4,h:5},{w:1,h:1}],storyFARLandscape:[{w:2,h:1},{w:16,h:9},{w:3,h:2},{w:4,h:3},{w:5,h:4},{w:1,h:1}]},B=["tl","tc","tr","bl","bc","br"],F=["left","center"],N=["top","center","bottom"],V=["none","uppercase"],Y=["sm","md","lg"],K=[1,.75],G=198,W=132,q=1,X=56,J=240,$="cubic-bezier(0.66, 0.025, 0.33, 0.975)",Q=1e3,ee=1500,et=2,en=3,er=20,eo=20,ei=2,ea=["processing","publishing","saving"],el=300.5,es=1,ec=0xc800000,eu=2500,ed=3,ep="pin-builder-default-education-id",ef="pin-builder-default-tour-id",eh="pin-builder-editing-tour-id",em="save_from_url",eg=["processing","edited","creating","saving","saved"],ey=2048},50865:function(e,t){t.Z=function(e){var t;return null!=e&&null!=(t=e.pin)&&t.id?e:null}},59784:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(132227),o=n(19035);function i(e){var t=e.accessibilityLabel;return(0,o.jsx)(r.kC,{alignItems:"center",justifyContent:"center",children:(0,o.jsx)(r.xH,{accessibilityLabel:t,show:!0})})}},143759:function(e,t,n){var r=n(258712);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var i=null,a=!1,l=0,s=function(){i&&clearTimeout(i),a=!0,i=setTimeout(function(){a=!1},100)},c=function(){0===l&&window.addEventListener("scroll",s),l+=1},u=function(){(l-=1)||window.removeEventListener("scroll",s)};t.Z=function(){var e,t=function(e){if(Array.isArray(e))return e}(e=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{i=(n=n.call(e)).next,!1;for(;!(s=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(e,2)||function(e,t){if(e){if("string"==typeof e)return o(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=t[0],i=t[1],l=(0,r.useRef)(null);(0,r.useEffect)(function(){return c(),function(){l.current&&clearTimeout(l.current),u()}},[]);var s=function e(t){l.current&&clearTimeout(l.current),l.current=t&&a?setTimeout(function(){return e(!0)},100):setTimeout(function(){i(t)},32)};return{isHovering:n,hoverHandlers:(0,r.useRef)({onMouseOver:function(){return s(!0)},onMouseLeave:function(){return s(!1)}}).current}}},47829:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(258712),o=n(267486);function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function l(){var e=(0,r.useRef)([]),t=(0,r.useRef)({});return(0,r.useEffect)(function(){return function(){[].concat(i(Object.keys(t.current).map(function(e){return t.current[e]})),i(e.current)).forEach(function(e){return e()})}},[]),function(n,r){if(r){var a=t.current[r];a&&(a(),delete t.current[r])}var l=(0,o.Z)(n),s=l.cancel,c=l.promise;return r?t.current[r]=s:e.current=[].concat(i(e.current),[s]),c}}},332245:function(e,t,n){n.d(t,{MM:function(){return a},Y8:function(){return i},bl:function(){return l},qj:function(){return s}});var r=n(51340),o=n(761732);function i(e,t){return e?t._('Title too long. Make sure all cards\' titles have less than 100 characters', 'Title entered is too long while editing a carousel pin and/or one of its pins', 'Title entered is too long while editing a carousel pin and/or one of its pins'):t._('Title too long. Make sure title has less than 100 characters', 'Title entered is too long while editing a pin', 'Title entered is too long while editing a pin')}function a(e,t){return e?t._('Description too long. Make sure all cards\' descriptions have less than 500 characters', 'Description entered is too long while editing a carousel pin and/or one of its pins', 'Description entered is too long while editing a carousel pin and/or one of its pins'):(0,r.nk)(t._('Description too long. Make sure description has less than {{ limit }} characters', 'editPinModal.errorMessages.descriptionError', 'Description entered is too long while editing a pin. limit: the maximum number of characters allowed'),{limit:o.JO}).join("")}function l(e,t){return t._('Too many mentions. Make sure you have at most 5.', 'editPinModal.errorMessages.userMentionOverLimit', 'Too many mentions used in the description')}function s(e,t){return e?t._('Need to provide a valid URL. Make sure all cards\' links are valid', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins'):t._('Need to provide a valid URL. Make sure the link is valid', 'Invalid URL/link provided while editing a pin', 'Invalid URL/link provided while editing a pin')}},486738:function(e,t,n){n.d(t,{Z:function(){return j}});var r=n(258712),o=n(132227),i=n(397657),a=n(41086),l=n(233846),s=n(51340),c=n(653810),u=n(47829),d=n(19035);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){b(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t,n){return(t=v(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){var t=function(e,t){if("object"!=p(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=p(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==p(t)?t:t+""}var x=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");l.prototype=Object.create(e&&e.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),Object.defineProperty(l,"prototype",{writable:!1}),e&&m(l,e);var t,n,r=(t=y(),function(){var e,n=_(l);return e=t?Reflect.construct(n,arguments,_(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==p(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return g(e)}(this,e)});function l(){var e;if(!(this instanceof l))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return b(g(e=r.call.apply(r,[this].concat(n))),"state",{recommendations:[],selectedIndex:0,resourceLoaded:!1}),b(g(e),"onDismiss",function(){}),b(g(e),"mounted",!1),b(g(e),"addHashtag",function(t){e.props.addHashtag(t),e.setState({recommendations:[]})}),b(g(e),"handleKeyDown",function(t){t.keyCode===c.Z.UP?e.handlePrevHashtag(t):t.keyCode===c.Z.DOWN?e.handleNextHashtag(t):t.keyCode===c.Z.ESCAPE?e.handleClose(t):t.keyCode===c.Z.ENTER&&e.handleSubmit(t)}),b(g(e),"handlePrevHashtag",function(t){t.preventDefault(),e.state.selectedIndex>0&&e.setState(function(e){return{selectedIndex:e.selectedIndex-1}})}),b(g(e),"handleNextHashtag",function(t){t.preventDefault(),e.state.selectedIndex<e.state.recommendations.length-1&&e.setState(function(e){return{selectedIndex:e.selectedIndex+1}})}),b(g(e),"handleClose",function(t){t.preventDefault(),e.setState({recommendations:[]})}),b(g(e),"handleSubmit",function(t){t.preventDefault(),e.addHashtag(e.state.recommendations[e.state.selectedIndex].query)}),b(g(e),"callResource",function(t){(0,e.props.makeCancelablePromise)((0,i.Z)({url:"/v3/search/autocomplete/",data:{q:t,show_pin_count:!0}}),"typeahead").then(function(t){if(e.mounted){var n=t.resource_response.data;e.setState({recommendations:n.slice(0,5),resourceLoaded:!0})}}).catch(function(t){t.isCanceled||e.setState({resourceLoaded:!1})})}),e}return n=[{key:"componentDidMount",value:function(){this.mounted=!0,this.callResource(this.props.query),window.addEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(e){this.props.query!==e.query&&""!==this.props.query&&this.callResource(this.props.query)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyDown),this.mounted=!1}},{key:"render",value:function(){var e=this,t=this.state,n=t.recommendations,r=t.resourceLoaded,i=t.selectedIndex,l=this.props,c=l.anchor,u=l.idealDirection,p=n.filter(function(e){return e.query}),f="flyout_"+p.length;return r&&p.length>0?(0,d.jsx)(o.J2,{anchor:c,idealDirection:u||"down",onDismiss:this.onDismiss,size:"sm",children:(0,d.jsx)(o.xu,{width:"100%",zIndex:new o.Ry(3),children:p.length>0?p.map(function(t,n){return(0,d.jsx)(o.iP,{fullWidth:!1,onTap:function(){return e.addHashtag(t.query)},children:(0,d.jsxs)(o.xu,{alignItems:"center",color:n===i?"secondary":"transparent",display:"flex",justifyContent:"between",padding:1,children:[(0,d.jsx)(o.xu,{flex:"grow",children:(0,d.jsx)(o.xv,{inline:!0,size:"200",weight:"bold",children:t.query})}),(0,d.jsx)(o.xu,{flex:"none",children:(0,d.jsx)(o.xv,{inline:!0,size:"100",children:(0,s.nk)(e.props.i18n.ngettext('{{ count }} pin', '{{ count }} pins', Number(t.pin_count), 'label for n pins in hashtag flyout', 'label for n pins in hashtag flyout'),{count:(0,d.jsx)(a.Z,{value:Number(t.pin_count)},"pinCount")})})})]})},t.query)}):null})},f):null}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,v(r.key),r)}}(l.prototype,n),Object.defineProperty(l,"prototype",{writable:!1}),l}(r.Component);function j(e){var t=(0,l.ZP)(),n=(0,u.Z)();return(0,d.jsx)(x,h(h({},e),{},{i18n:t,makeCancelablePromise:n}))}},238872:function(e,t,n){n.d(t,{d:function(){return r}});var r={BOARD:"board",PIN:"pin",DID_IT:"did_it",PINNER:"pinner",USER:"user",TODAY_ARTICLE:"today_article",FOLLOW_INVITE:"follow_invite"}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/1450-0e70047ec6f8c34d.js.map